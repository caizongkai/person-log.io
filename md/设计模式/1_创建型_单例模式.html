<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>创建型-单例模式 | Java 全栈知识体系</title>
    <meta name="description" content="包含: Java 基础, Java 部分源码, JVM, Spring, Spring Boot, Spring Cloud, 数据库原理, MySQL, ElasticSearch, MongoDB, Docker, k8s, CI&amp;CD, Linux, DevOps, 分布式, 中间件, 开发工具, Git, IDE, 源码阅读，读书笔记, 开源项目...">
    <link rel="icon" href="/person-log.io/images/photo.jpg">
  <link rel="manifest" href="/person-log.io/images/photo.jpg">
  <link rel="apple-touch-icon" href="/person-log.io/images/photo.jpg">
  <meta http-quiv="pragma" cotent="no-cache">
  <meta http-quiv="pragma" cotent="no-cache,must-revalidate">
  <meta http-quiv="expires" cotent="0">
    
    <link rel="preload" href="/person-log.io/assets/css/0.styles.4ff3082f.css" as="style"><link rel="preload" href="/person-log.io/assets/js/app.900e0138.js" as="script"><link rel="preload" href="/person-log.io/assets/js/21.9d613190.js" as="script"><link rel="prefetch" href="/person-log.io/assets/js/10.5d3102c6.js"><link rel="prefetch" href="/person-log.io/assets/js/100.8abb6c0d.js"><link rel="prefetch" href="/person-log.io/assets/js/101.e70ee001.js"><link rel="prefetch" href="/person-log.io/assets/js/102.8eb6e9a9.js"><link rel="prefetch" href="/person-log.io/assets/js/103.4868ab00.js"><link rel="prefetch" href="/person-log.io/assets/js/104.1f3ae061.js"><link rel="prefetch" href="/person-log.io/assets/js/105.b4d44644.js"><link rel="prefetch" href="/person-log.io/assets/js/106.ed41d71f.js"><link rel="prefetch" href="/person-log.io/assets/js/107.99d8e0f9.js"><link rel="prefetch" href="/person-log.io/assets/js/108.b8cdbf75.js"><link rel="prefetch" href="/person-log.io/assets/js/109.e598b3d2.js"><link rel="prefetch" href="/person-log.io/assets/js/11.dd8a8a0d.js"><link rel="prefetch" href="/person-log.io/assets/js/110.45af1b3c.js"><link rel="prefetch" href="/person-log.io/assets/js/111.62ae94fd.js"><link rel="prefetch" href="/person-log.io/assets/js/112.b9434dad.js"><link rel="prefetch" href="/person-log.io/assets/js/113.377bbf43.js"><link rel="prefetch" href="/person-log.io/assets/js/114.5a6b7bd8.js"><link rel="prefetch" href="/person-log.io/assets/js/115.103372d3.js"><link rel="prefetch" href="/person-log.io/assets/js/116.43e77bfc.js"><link rel="prefetch" href="/person-log.io/assets/js/117.fc88e5e3.js"><link rel="prefetch" href="/person-log.io/assets/js/118.a169c7d0.js"><link rel="prefetch" href="/person-log.io/assets/js/119.4434297d.js"><link rel="prefetch" href="/person-log.io/assets/js/12.f6fdf928.js"><link rel="prefetch" href="/person-log.io/assets/js/120.ae5585ff.js"><link rel="prefetch" href="/person-log.io/assets/js/121.b7238501.js"><link rel="prefetch" href="/person-log.io/assets/js/122.3aa0028c.js"><link rel="prefetch" href="/person-log.io/assets/js/123.889610c6.js"><link rel="prefetch" href="/person-log.io/assets/js/124.2d9a318a.js"><link rel="prefetch" href="/person-log.io/assets/js/125.72b2c2f7.js"><link rel="prefetch" href="/person-log.io/assets/js/126.bd4ce6c8.js"><link rel="prefetch" href="/person-log.io/assets/js/13.5710e644.js"><link rel="prefetch" href="/person-log.io/assets/js/14.dd6c1cd0.js"><link rel="prefetch" href="/person-log.io/assets/js/15.7149798f.js"><link rel="prefetch" href="/person-log.io/assets/js/16.7bd52a2f.js"><link rel="prefetch" href="/person-log.io/assets/js/17.4daa4746.js"><link rel="prefetch" href="/person-log.io/assets/js/18.d4bdd6a7.js"><link rel="prefetch" href="/person-log.io/assets/js/19.95ddf026.js"><link rel="prefetch" href="/person-log.io/assets/js/2.143de871.js"><link rel="prefetch" href="/person-log.io/assets/js/20.615f1176.js"><link rel="prefetch" href="/person-log.io/assets/js/22.eb619a13.js"><link rel="prefetch" href="/person-log.io/assets/js/23.70512efd.js"><link rel="prefetch" href="/person-log.io/assets/js/24.a299e3cc.js"><link rel="prefetch" href="/person-log.io/assets/js/25.e0bc91d9.js"><link rel="prefetch" href="/person-log.io/assets/js/26.bdd22671.js"><link rel="prefetch" href="/person-log.io/assets/js/27.6b7b12a6.js"><link rel="prefetch" href="/person-log.io/assets/js/28.d3ee9e71.js"><link rel="prefetch" href="/person-log.io/assets/js/29.3846b469.js"><link rel="prefetch" href="/person-log.io/assets/js/3.cd8ff11a.js"><link rel="prefetch" href="/person-log.io/assets/js/30.06463218.js"><link rel="prefetch" href="/person-log.io/assets/js/31.c52bcd52.js"><link rel="prefetch" href="/person-log.io/assets/js/32.aeb3a009.js"><link rel="prefetch" href="/person-log.io/assets/js/33.e9ece8bf.js"><link rel="prefetch" href="/person-log.io/assets/js/34.aa658d65.js"><link rel="prefetch" href="/person-log.io/assets/js/35.b0e6429a.js"><link rel="prefetch" href="/person-log.io/assets/js/36.11c95fd3.js"><link rel="prefetch" href="/person-log.io/assets/js/37.f6b7ce7c.js"><link rel="prefetch" href="/person-log.io/assets/js/38.2c0daf10.js"><link rel="prefetch" href="/person-log.io/assets/js/39.a2359299.js"><link rel="prefetch" href="/person-log.io/assets/js/4.f87d085e.js"><link rel="prefetch" href="/person-log.io/assets/js/40.67e9271b.js"><link rel="prefetch" href="/person-log.io/assets/js/41.b530b7d7.js"><link rel="prefetch" href="/person-log.io/assets/js/42.ceec96ec.js"><link rel="prefetch" href="/person-log.io/assets/js/43.1882528a.js"><link rel="prefetch" href="/person-log.io/assets/js/44.9c4e1af8.js"><link rel="prefetch" href="/person-log.io/assets/js/45.4ddef8e4.js"><link rel="prefetch" href="/person-log.io/assets/js/46.67313dc2.js"><link rel="prefetch" href="/person-log.io/assets/js/47.5c6b2c29.js"><link rel="prefetch" href="/person-log.io/assets/js/48.b7e57021.js"><link rel="prefetch" href="/person-log.io/assets/js/49.bff0de67.js"><link rel="prefetch" href="/person-log.io/assets/js/5.13ef03c9.js"><link rel="prefetch" href="/person-log.io/assets/js/50.0570550e.js"><link rel="prefetch" href="/person-log.io/assets/js/51.7e536feb.js"><link rel="prefetch" href="/person-log.io/assets/js/52.a011b658.js"><link rel="prefetch" href="/person-log.io/assets/js/53.c8ba3843.js"><link rel="prefetch" href="/person-log.io/assets/js/54.7ec121d9.js"><link rel="prefetch" href="/person-log.io/assets/js/55.516a38ec.js"><link rel="prefetch" href="/person-log.io/assets/js/56.62b2636e.js"><link rel="prefetch" href="/person-log.io/assets/js/57.b3111d41.js"><link rel="prefetch" href="/person-log.io/assets/js/58.4e4428b3.js"><link rel="prefetch" href="/person-log.io/assets/js/59.4bd160cb.js"><link rel="prefetch" href="/person-log.io/assets/js/6.246d68f0.js"><link rel="prefetch" href="/person-log.io/assets/js/60.147eae57.js"><link rel="prefetch" href="/person-log.io/assets/js/61.ece9faa7.js"><link rel="prefetch" href="/person-log.io/assets/js/62.42d5a03e.js"><link rel="prefetch" href="/person-log.io/assets/js/63.618c9a42.js"><link rel="prefetch" href="/person-log.io/assets/js/64.4a5e7887.js"><link rel="prefetch" href="/person-log.io/assets/js/65.e7fb9653.js"><link rel="prefetch" href="/person-log.io/assets/js/66.29e33acf.js"><link rel="prefetch" href="/person-log.io/assets/js/67.ce40420e.js"><link rel="prefetch" href="/person-log.io/assets/js/68.9ae9da96.js"><link rel="prefetch" href="/person-log.io/assets/js/69.798d9970.js"><link rel="prefetch" href="/person-log.io/assets/js/7.77d79df0.js"><link rel="prefetch" href="/person-log.io/assets/js/70.5ebe26ce.js"><link rel="prefetch" href="/person-log.io/assets/js/71.79a27be8.js"><link rel="prefetch" href="/person-log.io/assets/js/72.a4c84ae1.js"><link rel="prefetch" href="/person-log.io/assets/js/73.be2bf486.js"><link rel="prefetch" href="/person-log.io/assets/js/74.2e32e870.js"><link rel="prefetch" href="/person-log.io/assets/js/75.fbabbd25.js"><link rel="prefetch" href="/person-log.io/assets/js/76.ea1ba140.js"><link rel="prefetch" href="/person-log.io/assets/js/77.4ce215b3.js"><link rel="prefetch" href="/person-log.io/assets/js/78.4757c020.js"><link rel="prefetch" href="/person-log.io/assets/js/79.398d6895.js"><link rel="prefetch" href="/person-log.io/assets/js/8.f33fb86b.js"><link rel="prefetch" href="/person-log.io/assets/js/80.2913d38e.js"><link rel="prefetch" href="/person-log.io/assets/js/81.00d718fe.js"><link rel="prefetch" href="/person-log.io/assets/js/82.49baf639.js"><link rel="prefetch" href="/person-log.io/assets/js/83.0b255dec.js"><link rel="prefetch" href="/person-log.io/assets/js/84.aa39b1b8.js"><link rel="prefetch" href="/person-log.io/assets/js/85.220a5565.js"><link rel="prefetch" href="/person-log.io/assets/js/86.5381f000.js"><link rel="prefetch" href="/person-log.io/assets/js/87.55b5c1f1.js"><link rel="prefetch" href="/person-log.io/assets/js/88.f9d2f70c.js"><link rel="prefetch" href="/person-log.io/assets/js/89.d9463204.js"><link rel="prefetch" href="/person-log.io/assets/js/9.6dba6746.js"><link rel="prefetch" href="/person-log.io/assets/js/90.6b0a709d.js"><link rel="prefetch" href="/person-log.io/assets/js/91.4ae96144.js"><link rel="prefetch" href="/person-log.io/assets/js/92.b9357539.js"><link rel="prefetch" href="/person-log.io/assets/js/93.59c128af.js"><link rel="prefetch" href="/person-log.io/assets/js/94.1008960c.js"><link rel="prefetch" href="/person-log.io/assets/js/95.128fb549.js"><link rel="prefetch" href="/person-log.io/assets/js/96.d74f8117.js"><link rel="prefetch" href="/person-log.io/assets/js/97.afeacc56.js"><link rel="prefetch" href="/person-log.io/assets/js/98.4de04002.js"><link rel="prefetch" href="/person-log.io/assets/js/99.599f733a.js">
    <link rel="stylesheet" href="/person-log.io/assets/css/0.styles.4ff3082f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/person-log.io/" class="home-link router-link-active"><!----> <span class="site-name">Java 全栈知识体系</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/person-log.io/md/" class="nav-link router-link-active">导读</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/person-log.io/md/JAVA/" class="nav-link">JAVA基础</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/person-log.io/md/database/base/" class="nav-link">数据库基础</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/database/Mysql/" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/database/Redis/" class="nav-link">Redis</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">计算机网络</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/person-log.io/md/计算机网络/图解网络.html" class="nav-link">图解网络</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">项目部署</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/Docker/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/jenkins/" class="nav-link">jenkins</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/consul-cluster/" class="nav-link">consul</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/Nginx/" class="nav-link">Nginx</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/Linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/blog/" class="nav-link">个人博客</a></li></ul></div></div> <a href="https://github.com/caizongkai/vuepressDemo" target="_blank" rel="noopener noreferrer" class="repo-link">
    修改文档
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/person-log.io/md/" class="nav-link router-link-active">导读</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/person-log.io/md/JAVA/" class="nav-link">JAVA基础</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/person-log.io/md/database/base/" class="nav-link">数据库基础</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/database/Mysql/" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/database/Redis/" class="nav-link">Redis</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">计算机网络</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/person-log.io/md/计算机网络/图解网络.html" class="nav-link">图解网络</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">项目部署</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/Docker/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/jenkins/" class="nav-link">jenkins</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/consul-cluster/" class="nav-link">consul</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/Nginx/" class="nav-link">Nginx</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/Linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/blog/" class="nav-link">个人博客</a></li></ul></div></div> <a href="https://github.com/caizongkai/vuepressDemo" target="_blank" rel="noopener noreferrer" class="repo-link">
    修改文档
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>导航</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/person-log.io/md/JAVA/" class="sidebar-link">JAVA</a></li><li><a href="/person-log.io/md/DevOps/" class="sidebar-link">项目部署</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="创建型-单例模式"><a href="#创建型-单例模式" class="header-anchor">#</a> 创建型-单例模式</h1> <blockquote><p>本文主要分析单例模式(Singleton pattern): 确保一个类只有一个实例，并提供该实例的全局访问点, 本文介绍6中常用的实现方式。</p></blockquote> <p><img src="/person-log.io/assets/img/singleton.5903d5ed.png" alt="singleton"></p> <h2 id="类图"><a href="#类图" class="header-anchor">#</a> 类图</h2> <p>使用一个私有构造函数、一个私有静态变量以及一个公有静态函数来实现。</p> <p>私有构造函数保证了不能通过构造函数来创建对象实例，只能通过公有静态函数返回唯一的私有静态变量。</p> <p><img src="data:image/png;base64,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" alt="img"></p> <h3 id="懒汉式-线程不安全"><a href="#懒汉式-线程不安全" class="header-anchor">#</a> 懒汉式-线程不安全</h3> <p>以下实现中，私有静态变量 uniqueInstance 被延迟实例化，这样做的好处是，如果没有用到该类，那么就不会实例化 uniqueInstance，从而节约资源。</p> <p>这个实现在多线程环境下是不安全的，如果多个线程能够同时进入 <code>if (uniqueInstance == null)</code> ，并且此时 uniqueInstance 为 null，那么会有多个线程执行 <code>uniqueInstance = new Singleton();</code> 语句，这将导致多次实例化 uniqueInstance。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> uniqueInstance<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getUniqueInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>uniqueInstance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            uniqueInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> uniqueInstance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="饿汉式-线程安全"><a href="#饿汉式-线程安全" class="header-anchor">#</a> 饿汉式-线程安全</h3> <p>线程不安全问题主要是由于 uniqueInstance 被多次实例化，采取直接实例化 uniqueInstance 的方式就不会产生线程不安全问题。</p> <p>但是直接实例化的方式也丢失了延迟实例化带来的节约资源的好处。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> uniqueInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="懒汉式-线程安全"><a href="#懒汉式-线程安全" class="header-anchor">#</a> 懒汉式-线程安全</h3> <p>只需要对 getUniqueInstance() 方法加锁，那么在一个时间点只能有一个线程能够进入该方法，从而避免了多次实例化 uniqueInstance 的问题。</p> <p>但是当一个线程进入该方法之后，其它试图进入该方法的线程都必须等待，因此性能上有一定的损耗。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token class-name">Singleton</span> <span class="token function">getUniqueInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>uniqueInstance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        uniqueInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> uniqueInstance<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="双重校验锁-线程安全"><a href="#双重校验锁-线程安全" class="header-anchor">#</a> 双重校验锁-线程安全</h3> <p>uniqueInstance 只需要被实例化一次，之后就可以直接使用了。加锁操作只需要对实例化那部分的代码进行，只有当 uniqueInstance 没有被实例化时，才需要进行加锁。</p> <p>双重校验锁先判断 uniqueInstance 是否已经被实例化，如果没有被实例化，那么才对实例化语句进行加锁。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">volatile</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> uniqueInstance<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getUniqueInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>uniqueInstance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">Singleton</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>uniqueInstance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    uniqueInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> uniqueInstance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>考虑下面的实现，也就是只使用了一个 if 语句。在 uniqueInstance == null 的情况下，如果两个线程同时执行 if 语句，那么两个线程就会同时进入 if 语句块内。虽然在 if 语句块内有加锁操作，但是两个线程都会执行 <code>uniqueInstance = new Singleton();</code> 这条语句，只是先后的问题，那么就会进行两次实例化，从而产生了两个实例。因此必须使用双重校验锁，也就是需要使用两个 if 语句。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>uniqueInstance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">Singleton</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        uniqueInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>uniqueInstance 采用 volatile 关键字修饰也是很有必要的。<code>uniqueInstance = new Singleton();</code> 这段代码其实是分为三步执行。</p> <ol><li>分配内存空间</li> <li>初始化对象</li> <li>将 uniqueInstance 指向分配的内存地址</li></ol> <p>但是由于 JVM 具有指令重排的特性，有可能执行顺序变为了 1&gt;3&gt;2，这在单线程情况下自然是没有问题。但如果是多线程下，有可能获得是一个还没有被初始化的实例，以致于程序出错。</p> <h3 id="静态内部类实现"><a href="#静态内部类实现" class="header-anchor">#</a> 静态内部类实现</h3> <p>当 Singleton 类加载时，静态内部类 SingletonHolder 没有被加载进内存。只有当调用 <code>getUniqueInstance()</code> 方法从而触发 <code>SingletonHolder.INSTANCE</code> 时 SingletonHolder 才会被加载，此时初始化 INSTANCE 实例。</p> <p>这种方式不仅具有延迟初始化的好处，而且由虚拟机提供了对线程安全的支持。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">SingletonHolder</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Singleton</span> <span class="token constant">INSTANCE</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getUniqueInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">SingletonHolder</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="枚举实现"><a href="#枚举实现" class="header-anchor">#</a> 枚举实现</h3> <p>这是单例模式的最佳实践，它实现简单，并且在面对复杂的序列化或者反射攻击的时候，能够防止实例化多次。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>
    uniqueInstance<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/caizongkai/vuepressDemo/edit/main/docs/md/设计模式/1_创建型_单例模式.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <!----> </div> <!----></div></div>
    <script src="/person-log.io/assets/js/app.900e0138.js" defer></script><script src="/person-log.io/assets/js/21.9d613190.js" defer></script>
  </body>
</html>
