<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>对象 | Java 全栈知识体系</title>
    <meta name="description" content="包含: Java 基础, Java 部分源码, JVM, Spring, Spring Boot, Spring Cloud, 数据库原理, MySQL, ElasticSearch, MongoDB, Docker, k8s, CI&amp;CD, Linux, DevOps, 分布式, 中间件, 开发工具, Git, IDE, 源码阅读，读书笔记, 开源项目...">
    <link rel="icon" href="/person-log.io/images/photo.jpg">
  <link rel="manifest" href="/person-log.io/images/photo.jpg">
  <link rel="apple-touch-icon" href="/person-log.io/images/photo.jpg">
  <meta http-quiv="pragma" cotent="no-cache">
  <meta http-quiv="pragma" cotent="no-cache,must-revalidate">
  <meta http-quiv="expires" cotent="0">
    
    <link rel="preload" href="/person-log.io/assets/css/0.styles.4ff3082f.css" as="style"><link rel="preload" href="/person-log.io/assets/js/app.900e0138.js" as="script"><link rel="preload" href="/person-log.io/assets/js/8.f33fb86b.js" as="script"><link rel="prefetch" href="/person-log.io/assets/js/10.5d3102c6.js"><link rel="prefetch" href="/person-log.io/assets/js/100.8abb6c0d.js"><link rel="prefetch" href="/person-log.io/assets/js/101.e70ee001.js"><link rel="prefetch" href="/person-log.io/assets/js/102.8eb6e9a9.js"><link rel="prefetch" href="/person-log.io/assets/js/103.4868ab00.js"><link rel="prefetch" href="/person-log.io/assets/js/104.1f3ae061.js"><link rel="prefetch" href="/person-log.io/assets/js/105.b4d44644.js"><link rel="prefetch" href="/person-log.io/assets/js/106.ed41d71f.js"><link rel="prefetch" href="/person-log.io/assets/js/107.99d8e0f9.js"><link rel="prefetch" href="/person-log.io/assets/js/108.b8cdbf75.js"><link rel="prefetch" href="/person-log.io/assets/js/109.e598b3d2.js"><link rel="prefetch" href="/person-log.io/assets/js/11.dd8a8a0d.js"><link rel="prefetch" href="/person-log.io/assets/js/110.45af1b3c.js"><link rel="prefetch" href="/person-log.io/assets/js/111.62ae94fd.js"><link rel="prefetch" href="/person-log.io/assets/js/112.b9434dad.js"><link rel="prefetch" href="/person-log.io/assets/js/113.377bbf43.js"><link rel="prefetch" href="/person-log.io/assets/js/114.5a6b7bd8.js"><link rel="prefetch" href="/person-log.io/assets/js/115.103372d3.js"><link rel="prefetch" href="/person-log.io/assets/js/116.43e77bfc.js"><link rel="prefetch" href="/person-log.io/assets/js/117.fc88e5e3.js"><link rel="prefetch" href="/person-log.io/assets/js/118.a169c7d0.js"><link rel="prefetch" href="/person-log.io/assets/js/119.4434297d.js"><link rel="prefetch" href="/person-log.io/assets/js/12.f6fdf928.js"><link rel="prefetch" href="/person-log.io/assets/js/120.ae5585ff.js"><link rel="prefetch" href="/person-log.io/assets/js/121.b7238501.js"><link rel="prefetch" href="/person-log.io/assets/js/122.3aa0028c.js"><link rel="prefetch" href="/person-log.io/assets/js/123.889610c6.js"><link rel="prefetch" href="/person-log.io/assets/js/124.2d9a318a.js"><link rel="prefetch" href="/person-log.io/assets/js/125.72b2c2f7.js"><link rel="prefetch" href="/person-log.io/assets/js/126.bd4ce6c8.js"><link rel="prefetch" href="/person-log.io/assets/js/13.5710e644.js"><link rel="prefetch" href="/person-log.io/assets/js/14.dd6c1cd0.js"><link rel="prefetch" href="/person-log.io/assets/js/15.7149798f.js"><link rel="prefetch" href="/person-log.io/assets/js/16.7bd52a2f.js"><link rel="prefetch" href="/person-log.io/assets/js/17.4daa4746.js"><link rel="prefetch" href="/person-log.io/assets/js/18.d4bdd6a7.js"><link rel="prefetch" href="/person-log.io/assets/js/19.95ddf026.js"><link rel="prefetch" href="/person-log.io/assets/js/2.143de871.js"><link rel="prefetch" href="/person-log.io/assets/js/20.615f1176.js"><link rel="prefetch" href="/person-log.io/assets/js/21.9d613190.js"><link rel="prefetch" href="/person-log.io/assets/js/22.eb619a13.js"><link rel="prefetch" href="/person-log.io/assets/js/23.70512efd.js"><link rel="prefetch" href="/person-log.io/assets/js/24.a299e3cc.js"><link rel="prefetch" href="/person-log.io/assets/js/25.e0bc91d9.js"><link rel="prefetch" href="/person-log.io/assets/js/26.bdd22671.js"><link rel="prefetch" href="/person-log.io/assets/js/27.6b7b12a6.js"><link rel="prefetch" href="/person-log.io/assets/js/28.d3ee9e71.js"><link rel="prefetch" href="/person-log.io/assets/js/29.3846b469.js"><link rel="prefetch" href="/person-log.io/assets/js/3.cd8ff11a.js"><link rel="prefetch" href="/person-log.io/assets/js/30.06463218.js"><link rel="prefetch" href="/person-log.io/assets/js/31.c52bcd52.js"><link rel="prefetch" href="/person-log.io/assets/js/32.aeb3a009.js"><link rel="prefetch" href="/person-log.io/assets/js/33.e9ece8bf.js"><link rel="prefetch" href="/person-log.io/assets/js/34.aa658d65.js"><link rel="prefetch" href="/person-log.io/assets/js/35.b0e6429a.js"><link rel="prefetch" href="/person-log.io/assets/js/36.11c95fd3.js"><link rel="prefetch" href="/person-log.io/assets/js/37.f6b7ce7c.js"><link rel="prefetch" href="/person-log.io/assets/js/38.2c0daf10.js"><link rel="prefetch" href="/person-log.io/assets/js/39.a2359299.js"><link rel="prefetch" href="/person-log.io/assets/js/4.f87d085e.js"><link rel="prefetch" href="/person-log.io/assets/js/40.67e9271b.js"><link rel="prefetch" href="/person-log.io/assets/js/41.b530b7d7.js"><link rel="prefetch" href="/person-log.io/assets/js/42.ceec96ec.js"><link rel="prefetch" href="/person-log.io/assets/js/43.1882528a.js"><link rel="prefetch" href="/person-log.io/assets/js/44.9c4e1af8.js"><link rel="prefetch" href="/person-log.io/assets/js/45.4ddef8e4.js"><link rel="prefetch" href="/person-log.io/assets/js/46.67313dc2.js"><link rel="prefetch" href="/person-log.io/assets/js/47.5c6b2c29.js"><link rel="prefetch" href="/person-log.io/assets/js/48.b7e57021.js"><link rel="prefetch" href="/person-log.io/assets/js/49.bff0de67.js"><link rel="prefetch" href="/person-log.io/assets/js/5.13ef03c9.js"><link rel="prefetch" href="/person-log.io/assets/js/50.0570550e.js"><link rel="prefetch" href="/person-log.io/assets/js/51.7e536feb.js"><link rel="prefetch" href="/person-log.io/assets/js/52.a011b658.js"><link rel="prefetch" href="/person-log.io/assets/js/53.c8ba3843.js"><link rel="prefetch" href="/person-log.io/assets/js/54.7ec121d9.js"><link rel="prefetch" href="/person-log.io/assets/js/55.516a38ec.js"><link rel="prefetch" href="/person-log.io/assets/js/56.62b2636e.js"><link rel="prefetch" href="/person-log.io/assets/js/57.b3111d41.js"><link rel="prefetch" href="/person-log.io/assets/js/58.4e4428b3.js"><link rel="prefetch" href="/person-log.io/assets/js/59.4bd160cb.js"><link rel="prefetch" href="/person-log.io/assets/js/6.246d68f0.js"><link rel="prefetch" href="/person-log.io/assets/js/60.147eae57.js"><link rel="prefetch" href="/person-log.io/assets/js/61.ece9faa7.js"><link rel="prefetch" href="/person-log.io/assets/js/62.42d5a03e.js"><link rel="prefetch" href="/person-log.io/assets/js/63.618c9a42.js"><link rel="prefetch" href="/person-log.io/assets/js/64.4a5e7887.js"><link rel="prefetch" href="/person-log.io/assets/js/65.e7fb9653.js"><link rel="prefetch" href="/person-log.io/assets/js/66.29e33acf.js"><link rel="prefetch" href="/person-log.io/assets/js/67.ce40420e.js"><link rel="prefetch" href="/person-log.io/assets/js/68.9ae9da96.js"><link rel="prefetch" href="/person-log.io/assets/js/69.798d9970.js"><link rel="prefetch" href="/person-log.io/assets/js/7.77d79df0.js"><link rel="prefetch" href="/person-log.io/assets/js/70.5ebe26ce.js"><link rel="prefetch" href="/person-log.io/assets/js/71.79a27be8.js"><link rel="prefetch" href="/person-log.io/assets/js/72.a4c84ae1.js"><link rel="prefetch" href="/person-log.io/assets/js/73.be2bf486.js"><link rel="prefetch" href="/person-log.io/assets/js/74.2e32e870.js"><link rel="prefetch" href="/person-log.io/assets/js/75.fbabbd25.js"><link rel="prefetch" href="/person-log.io/assets/js/76.ea1ba140.js"><link rel="prefetch" href="/person-log.io/assets/js/77.4ce215b3.js"><link rel="prefetch" href="/person-log.io/assets/js/78.4757c020.js"><link rel="prefetch" href="/person-log.io/assets/js/79.398d6895.js"><link rel="prefetch" href="/person-log.io/assets/js/80.2913d38e.js"><link rel="prefetch" href="/person-log.io/assets/js/81.00d718fe.js"><link rel="prefetch" href="/person-log.io/assets/js/82.49baf639.js"><link rel="prefetch" href="/person-log.io/assets/js/83.0b255dec.js"><link rel="prefetch" href="/person-log.io/assets/js/84.aa39b1b8.js"><link rel="prefetch" href="/person-log.io/assets/js/85.220a5565.js"><link rel="prefetch" href="/person-log.io/assets/js/86.5381f000.js"><link rel="prefetch" href="/person-log.io/assets/js/87.55b5c1f1.js"><link rel="prefetch" href="/person-log.io/assets/js/88.f9d2f70c.js"><link rel="prefetch" href="/person-log.io/assets/js/89.d9463204.js"><link rel="prefetch" href="/person-log.io/assets/js/9.6dba6746.js"><link rel="prefetch" href="/person-log.io/assets/js/90.6b0a709d.js"><link rel="prefetch" href="/person-log.io/assets/js/91.4ae96144.js"><link rel="prefetch" href="/person-log.io/assets/js/92.b9357539.js"><link rel="prefetch" href="/person-log.io/assets/js/93.59c128af.js"><link rel="prefetch" href="/person-log.io/assets/js/94.1008960c.js"><link rel="prefetch" href="/person-log.io/assets/js/95.128fb549.js"><link rel="prefetch" href="/person-log.io/assets/js/96.d74f8117.js"><link rel="prefetch" href="/person-log.io/assets/js/97.afeacc56.js"><link rel="prefetch" href="/person-log.io/assets/js/98.4de04002.js"><link rel="prefetch" href="/person-log.io/assets/js/99.599f733a.js">
    <link rel="stylesheet" href="/person-log.io/assets/css/0.styles.4ff3082f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/person-log.io/" class="home-link router-link-active"><!----> <span class="site-name">Java 全栈知识体系</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/person-log.io/md/" class="nav-link router-link-active">导读</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/person-log.io/md/JAVA/" class="nav-link">JAVA基础</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/person-log.io/md/database/base/" class="nav-link">数据库基础</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/database/Mysql/" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/database/Redis/" class="nav-link router-link-active">Redis</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">计算机网络</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/person-log.io/md/计算机网络/图解网络.html" class="nav-link">图解网络</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">项目部署</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/Docker/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/jenkins/" class="nav-link">jenkins</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/consul-cluster/" class="nav-link">consul</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/Nginx/" class="nav-link">Nginx</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/Linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/blog/" class="nav-link">个人博客</a></li></ul></div></div> <a href="https://github.com/caizongkai/vuepressDemo" target="_blank" rel="noopener noreferrer" class="repo-link">
    修改文档
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/person-log.io/md/" class="nav-link router-link-active">导读</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/person-log.io/md/JAVA/" class="nav-link">JAVA基础</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/person-log.io/md/database/base/" class="nav-link">数据库基础</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/database/Mysql/" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/database/Redis/" class="nav-link router-link-active">Redis</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">计算机网络</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/person-log.io/md/计算机网络/图解网络.html" class="nav-link">图解网络</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">项目部署</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/Docker/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/jenkins/" class="nav-link">jenkins</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/consul-cluster/" class="nav-link">consul</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/Nginx/" class="nav-link">Nginx</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/Linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/person-log.io/md/DevOps/blog/" class="nav-link">个人博客</a></li></ul></div></div> <a href="https://github.com/caizongkai/vuepressDemo" target="_blank" rel="noopener noreferrer" class="repo-link">
    修改文档
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>数据库基础</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/person-log.io/md/database/base/04-数据库核心知识点.html" class="sidebar-link">数据库核心知识点</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>MySQL</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/person-log.io/md/database/Mysql/MySQL-01-数据类型.html" class="sidebar-link">数据类型</a></li><li><a href="/person-log.io/md/database/Mysql/MySQL-02-存储引擎.html" class="sidebar-link">存储引擎</a></li><li><a href="/person-log.io/md/database/Mysql/MySQL-03-索引.html" class="sidebar-link">索引</a></li><li><a href="/person-log.io/md/database/Mysql/MySQL-04-优化.html" class="sidebar-link">优化</a></li><li><a href="/person-log.io/md/database/Mysql/MySQL-07-一条SQL的执行过程详解.html" class="sidebar-link">一条SQL的执行过程详解</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Redis</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/person-log.io/md/database/Redis/" aria-current="page" class="sidebar-link">Redis知识体系详解</a></li><li><a href="/person-log.io/md/database/Redis/数据结构与对象/Redis-01-SDS.html" class="sidebar-link">Redis数据结构-SDS</a></li><li><a href="/person-log.io/md/database/Redis/数据结构与对象/Redis-02-链表.html" class="sidebar-link">Redis数据结构-链表</a></li><li><a href="/person-log.io/md/database/Redis/数据结构与对象/Redis-03-字典.html" class="sidebar-link">Redis数据结构-字典</a></li><li><a href="/person-log.io/md/database/Redis/数据结构与对象/Redis-04-跳跃表.html" class="sidebar-link">Redis数据结构-跳跃表</a></li><li><a href="/person-log.io/md/database/Redis/数据结构与对象/Redis-05-整数集合.html" class="sidebar-link">Redis数据结构-整数集合</a></li><li><a href="/person-log.io/md/database/Redis/数据结构与对象/Redis-06-压缩列表.html" class="sidebar-link">Redis数据结构-压缩列表</a></li><li><a href="/person-log.io/md/database/Redis/数据结构与对象/Redis-07-对象.html" class="active sidebar-link">Redis对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/person-log.io/md/database/Redis/数据结构与对象/Redis-07-对象.html#对象的结构" class="sidebar-link">对象的结构</a></li><li class="sidebar-sub-header"><a href="/person-log.io/md/database/Redis/数据结构与对象/Redis-07-对象.html#字符串对象" class="sidebar-link">字符串对象</a></li><li class="sidebar-sub-header"><a href="/person-log.io/md/database/Redis/数据结构与对象/Redis-07-对象.html#列表对象" class="sidebar-link">列表对象</a></li><li class="sidebar-sub-header"><a href="/person-log.io/md/database/Redis/数据结构与对象/Redis-07-对象.html#哈希对象" class="sidebar-link">哈希对象</a></li><li class="sidebar-sub-header"><a href="/person-log.io/md/database/Redis/数据结构与对象/Redis-07-对象.html#集合对象" class="sidebar-link">集合对象</a></li><li class="sidebar-sub-header"><a href="/person-log.io/md/database/Redis/数据结构与对象/Redis-07-对象.html#有序集合对象" class="sidebar-link">有序集合对象</a></li><li class="sidebar-sub-header"><a href="/person-log.io/md/database/Redis/数据结构与对象/Redis-07-对象.html#类型检查与命令多态" class="sidebar-link">类型检查与命令多态</a></li><li class="sidebar-sub-header"><a href="/person-log.io/md/database/Redis/数据结构与对象/Redis-07-对象.html#内存回收" class="sidebar-link">内存回收</a></li><li class="sidebar-sub-header"><a href="/person-log.io/md/database/Redis/数据结构与对象/Redis-07-对象.html#对象的空转时长" class="sidebar-link">对象的空转时长</a></li></ul></li><li><a href="/person-log.io/md/database/Redis/one-Redis/Redis-01-数据库.html" class="sidebar-link">Redis数据库</a></li><li><a href="/person-log.io/md/database/Redis/one-Redis/Redis-02-RDB.html" class="sidebar-link">RDB</a></li><li><a href="/person-log.io/md/database/Redis/one-Redis/Redis-03-AOF.html" class="sidebar-link">AOF</a></li><li><a href="/person-log.io/md/database/Redis/one-Redis/Redis-04-事件.html" class="sidebar-link">事件</a></li><li><a href="/person-log.io/md/database/Redis/multi-redis/Redis-01-主从复制.html" class="sidebar-link">主从复制</a></li><li><a href="/person-log.io/md/database/Redis/multi-redis/Redis-02-哨兵机制.html" class="sidebar-link">哨兵机制</a></li><li><a href="/person-log.io/md/database/Redis/redis-install.html" class="sidebar-link">redis实战-redis安装</a></li><li><a href="/person-log.io/md/database/Redis/redis-sentinel.html" class="sidebar-link">redis实战-哨兵模式配置</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="对象"><a href="#对象" class="header-anchor">#</a> 对象</h1> <p>Redis<strong>没有直接使用</strong>前文的数据结构来实现键值对数据库，而是基于这些数据结构构建了一个对象系统，通过对象组织数据结构，包括字<strong>符串对象，列表对象，哈希对象，集合对象</strong>和<strong>有序集合对象这</strong>5种对象。</p> <h2 id="对象的结构"><a href="#对象的结构" class="header-anchor">#</a> <strong>对象的结构</strong></h2> <p>Redis使用对象来表示数据库的键和值。每个对象都是一个redisObject结构，是一个按照位段存储的结构，节约内存：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">redisObject</span><span class="token punctuation">{</span>
    <span class="token comment">//类型</span>
    <span class="token keyword">unsigned</span> type <span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token comment">//编码</span>
    <span class="token keyword">unsigned</span> encoding<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token comment">//指向底层实现数据结构的指针</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span> robj<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="type"><a href="#type" class="header-anchor">#</a> type</h3> <p>type：记录对象的类型：</p> <p><img src="/person-log.io/assets/img/image-20210305153525040.7ee7b848.png" alt="image-20210305153525040"></p> <h3 id="encoding"><a href="#encoding" class="header-anchor">#</a> encoding</h3> <p>encoding记录对象使用的编码，即对象底层使用的具体数据结构：</p> <p><img src="/person-log.io/assets/img/image-20210305153712975.87cb1380.png" alt="image-20210305153712975"></p> <p>使用object encoding命令可以查看键的值对象的编码，每个对象都至少使用两种不同编码常量：</p> <p><img src="/person-log.io/assets/img/image-20210305153809033.bf8b6776.png" alt="image-20210305153809033"></p> <h2 id="字符串对象"><a href="#字符串对象" class="header-anchor">#</a> <strong>字符串对象</strong></h2> <p>字符串对象可以是<strong>int，raw</strong>或<strong>embstr</strong>。</p> <ul><li>如果字符串对象保存的是整数值，且这个数值可用long表示，底层就会以REDIS_ENCODING_INT编码来实现。</li> <li>如果字符串对象是一个字符串值，且这个字符串长度&gt;39字节，字符串将使用一个SDS保存，底层编码为REDIS_ENCODING_RAW。</li> <li>如果字符串对象保存的是字符串，且这个字符串长度&lt;=39字节，底层编码就是REDIS_ENCODING_EMBSTR，使用embstr编码的方式保存字符串。</li></ul> <h3 id="embstr编码"><a href="#embstr编码" class="header-anchor">#</a> <strong>embstr编码</strong></h3> <p>专门用于保存短字符串的一种优化编码方式，与raw的效果相同，都使用redisObject和sdshdr结构来表示字符串对象，但是raw会调用两次内存分配函数分别创建redisObject和sdshdr结构。embstr编码则通过调用一次内存分配函数来分配一块连续空间，空间依次包括redisObject和sdshdr俩结构。</p> <p>使用embstr编码保存短字符串的<strong>优点</strong>：</p> <ul><li>内存分配次数由两次降为<strong>1次</strong>。</li> <li>释放embstr字符串对象只需调用<strong>1次</strong>内存释放函数。</li> <li>embstr字符串放在一块连续的内存中，能更好地<strong>利用缓存</strong>带来的优势</li></ul> <h3 id="编码的转换"><a href="#编码的转换" class="header-anchor">#</a> <strong>编码的转换</strong></h3> <p><code>int-&gt;raw</code>：对int编码的字符串对象执行后，保存的不再是整数值，而是字符串值时。比如整数追加字符串。</p> <p><code>embstr-&gt;raw</code>：Redis没有为embstr编写修改程序，所以是<strong>只读的</strong>，当embstr编码的字符串修改后，就变成raw编码的字符串对象。</p> <h2 id="列表对象"><a href="#列表对象" class="header-anchor">#</a> <strong>列表对象</strong></h2> <p>列表对象的编码是ziplist或linkedlist。</p> <p>当列表可以同时满足以下两个条件时，列表对象使用ziplist编码：</p> <ul><li>列表对象保存的所有字符串元素的长度都&lt;64字节</li> <li>列表对象保存的元素数量&lt;512个</li></ul> <p>否则使用linkedlist编码。</p> <p>注：两条件的上限值可通过配置文件修改。</p> <h2 id="哈希对象"><a href="#哈希对象" class="header-anchor">#</a> <strong>哈希对象</strong></h2> <p>哈希对象的编码可以是ziplist或hashtable。</p> <ul><li>ziplist的数据结构：每当有新的键值对插入哈希对象时，Redis会先将保存键的压缩列表节点推入表尾，再将保存值的压缩列表节点推入表尾。</li> <li>hashtable的数据结构：字典的每个键都是一个字符串对象，保存键；字典的每个值都是字符串对象，保存值</li></ul> <p>当哈希对象可以同时满足下两个条件时，使用ziplist编码：</p> <ul><li>哈希对象保存的所有键值对的值和键都&lt;64字节</li> <li>哈希对象保存的键值对数量&lt;512个</li></ul> <p>否则使用hashtable编码。</p> <h2 id="集合对象"><a href="#集合对象" class="header-anchor">#</a> <strong>集合对象</strong></h2> <p>集合对象的编码可以是intset或hashtable。</p> <p>如果以hashtable编码作为集合对象底层实现，那么字典的每个键都是一个字符串对象，值都是null。</p> <p>当集合对象同时满足以下两个条件时，使用intset编码：</p> <ul><li>集合对象保存的所有元素都是整数值</li> <li>集合对象保存的元素数量&lt;=512个</li></ul> <p>否则使用hashtable编码。</p> <p>注：两条件的上限值可通过配置文件修改。</p> <h2 id="有序集合对象"><a href="#有序集合对象" class="header-anchor">#</a> <strong>有序集合对象</strong></h2> <p>有序集合的编码可以是ziplist或skiplist。</p> <p>使用ziplist编码时，每个元素使用<strong>两个紧挨在一起的压缩列表节点</strong>来保存，第一个节点保存元素的成员，而第二个元素则保存元素的分值。</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAxcAAABkCAYAAAD0fs3OAAAgAElEQVR4nO2d2ZXjOg6GqTmTwiTRDsJ0EL5BTBKmgrhJVAUhKQhXBPM2QXAeeqCGYXDTYi38v3N8usuWuIIgQYJk4733BgAAAAAAAABm8o+tEwAAAAAAAAA4BzAuAAAAAAAAAIsA4wIA8MIwDOZ2uxW/d7vdzDAM499N0xSFw9/l3zVNo/6WSsuUPLRt+/bdlPg1SsOgvDdNMzvuszO3rknmtfoP0TTNWxjDMJi2bbPq7Pv7+y2MLepbymXbtpPKcwmo7ErqoXam6CdZvlJ356K9M6XuhmEwPz8/xe9JpuZjCUh2t4p/d3gAAPDe930/fowx3lqb/a5zzhtjvHNu/M4Y440xvu/75PvW2vF57cPDzWHOe/Kd0nCcc9455621Y7nQ536/F6eH1DSFm1OeNaHJ3pR3eFnnEHo/V+6/vr7GdsbbnazvNaFy0L7Ljbvv+zGtJPdT266Mm8oFvEPlUiq3VMZcv1MYuTqfnqX6lnVeWmdTdaOmq6cMa0mGKR/UJkugd9dus0fhn4taKgCAw2KtNcYY47031lrT970ZhsFcr9fku865YJh935u+740xxjweD/U5+n0pnHPBNIVYYhaubduXePu+f/k7lH/+Pi8vgs9mW2tN13VF6TojTdOMZUHlbK3NktcYss5TdSYh2ev7PpoWiqfv+7HtEby+nXPGr3TuitbuSF5lmmLItsbDSNUHrZLwtPD2C3l/h8qs67qxrNq2LZJVre67rhvlMlV3mp7iv81thzE0vTxlxUDq6yXSwWXXOVesP07D1tYNAGB7+Aw7If8OwWdcU5/QrI6c4c99T0IzTnx2jv7NLQM+Y6XN7K4FTzfNAvP8l5TD2ZHyKmf9c9+dKq/eh1cucmQmlAa+2pU7ixxaMZCyHMqDTGtuOS7B8/kcZ761GfCS1dOamKqr+bNz5D/13pT8lKxcaPpwio6cszIW6/ewyuw9jAsAQLBTyOnguULVBjik9J/PZzCM1IAvB1L2fGDOv48NtrT0ysE9H/zkdGDSXcQ55y+XyziADBFzEYNx8RsqI80QjJURlwVezrmDWl6nmsyEBsihdGrh5A6SYu0lJWOpcuAyW9oGpcxrZSDfick8eCU2sE6VV0inSD2XGhSn3FhLMcb4r6+vrGe57HL305Dslhob0sUv1f9BdnXqzj0AIDpTmhpMc8XqfXw2J9Z5yA5O+r/mKHrZuXDlzsPXOs5YR5kzyA8ZVtqAL8eXXg46p8xKn5WYTMaMMDmI9T5u1Gph5KywpQbU2qAuN34tT1MoWb3RBkpT3k8Z1NIw0+Ko3biO7YfTDG6ONEDmTOjEZJ/ruRwoHZfL5U2Pxtr4VLnjekCbDND0dqydxcpRGu41AeMCgIrhs/0czdWCK1juwhPqsOTv0rjgs0QpBZ9S0NL9KWZchDosbYOjfD7k8qLN1vLOJWeJPDf/NS+5hwwLrdxl+fDfpJzQdyk50cKjtsEHWPz/GnyQGBqcrFm/clZXa8syn1oY2gpFzuCUhxsbkPHwa5R3Tsiw0HSofEZO+lC9hwbYIbnVJn5K9XWuUZBjnMvwuFtsqG+TxoUWd4rcPNQsvzAuAKiYXCUpBz0hF6TYLI40LlKz83LAGHOrkB0ZhRX6XSsH7dQe2ZGFjAsJjz9noBorl1hHXROau1HuAIXKlJ8K431cXmOEZFfKbKzuU2lfE7m6EnMLy5Vfeo7LfgrSCVsYWEejVE9THYYM31iYOSsGmszk6GtpfJfKvHw2JDO5blFcp+fKOjcaQnqo9lU2GBcAVAgfbMlVCDmQplmX2GxWSNnnzGTmuljEBml8MCR9cnMGKqHOWZZLrnEhO/BSF4FQ/msdbMnBsCYXXM5iMjNHXrW45V4c3rZChFYu+MqUlOslSQ3mZVnmDtBK2kgqLbUb04TUYZqO4uUfWm3mYRE8HC6LMXJ0dUn9a/I3JX5uJGuGVCo8+n+JURByA4bswrgAoFqkEpWdQu4gITZYy+lsYgPqXONEUnrqDH+GOgxtBiyn49RmB0s6rNSMfI0zYppxK+sid1CTu9IWeo/LJU+fNDj47GYsrNRnDYOSGy/aaoNceUvB/f1DKxehfOSsQNVqVHv/R/Z5Gcj9FTkGLX+OmGIYxOpJuqem4Lryfr9nr5CFBvPaKk2OOyq9X6pfU+04Z3P8WYFxAQBQ/VOnDNboPT64SrlJ5Ay0pl5olNtZ8OeoLGQac9yreNxa2BSWFkbOqkVunZwdbVYyd1ATMi5CA22N0Iyl5uqhya9zf04O0wzH3FnXWB5zjBsZH89f7ky29z4aFn2n1c39fg8Oynhd1GhQh0i5gcaIrVzkrjrlGIMl+aDnv76+sgbj/B2t35Kufjlp4Ct2UtZSez9SslvrKgZ6KQCAOhDP7dRjs2E5s/3aYEw7OSaXnKNnJbkdZCotoUFvidGmuTjMHWyeCW3gUFI+sZWL3A3JcoZ0qlvQ1FWqkpUPLT9y5SKU5xI3GTmLnhPO8/l8iZ+ni8LMLcta0Gbkcwf1a61cSH2dg1x9yc0Hl7dYu8/RB1p58HdCm8LpN201k7uYYeUCAFAlfKDGZ8RKOglN2cuNtMaYcaaWE9qkqw2epGuAlhceTglah8kHS9KvXoOnWeswNX/2VBj82VD4NaHtp+F1U+Kz7f27USL3QmgyF5pRLzEupAEs3ZBichYyQkKrFBohg57Hwcs1hFYOWv5jbSfkJz+nPZ8VbliQ3JSs7sj3pS6SdSHDDBm12l6QGKE08zYdIiT/POyYURBLQ8jdMZQezUiXq9y1TgjBuACgUmKdS0mHrin70IfP5EjDxnv9SMzQBl6ej6mrHITsSOWxu5rRof2ulVlodjr0XGzVpmY3Ec240uQlRYm8yjqNySI9m0oLPXO5XN7SRHGkDOkl4HGkBpHau7H2FipL+Sy5RYVkPte9pQZk25d6JUde5qx4aXWu6fZUHxLTYSldz9/nh5FwUu/LCYrc8gmlIyTjtbux1plrAEDQD7p0AJvj+lSSJmmEeP96Jwb/jg/I1xyQxWawcmbJ+ExgKJ1ygBDrAGsjNqNZKq/cbYHXR+77mlHsfXpQI+PnN9bvcRASWw2iPMbam5T5lOtKaNBHg8iaCdVFzky/9jyVcemKlyRkRITCzWkfXNdPSVfKwI8ZYzLumL7m6YvJbo362nsYFwAAhdLOfMnOPzesT83w8vg+zSfzt2dSZbCFvGoDPfp+Snr2WM+fTlPNg7EYqYmLJcKZSmmYn5CpqXpzTtpo0gH8pvHeewMAAAAAAAAAM/nH1gkAAAAAAAAAnAMYFwAAAAAAAIBFgHEBAAAAAAAAWAQYFwCA6miaxrRtu3UyzO12201awH5o2/bjckFx3m63j8UJ9s0WcmjMb/08DMNH4wTLAuMCAAA2wjk3/osOFRAkF9baj8X5eDyMtdb0fQ85BOZ2u41y+ElI9vq+/3jcYDlgXAAAwEZcr1fjvX8ZTGLmuG5olthaa67X60fj5nIIA6NOhmEwTdOMg3vvvXk8Hh+LH0bFOYBxAQAAG/N4PEzf9+PMcdM0WycJbEDbtuMAv+u6j8d/vV7Hwd0nV03APmiaZqx3a63BTQVgKjAuAABgB1yvV9N13di5k/87ZpDrgc8Wb8X1eh0NHKyi1cEwDC913ff9JsYtOA8wLgAAYEd0XTe6StFqBgZ552cYhrG+t4bvv4DsnZu2bce6ds4Z7/3H3fHA+YBxAQCoki02K5aguUrhVKlzMgzDaFTsRS5pFa3ve9O2LVbQTgadVOecG+v5k3srUuwpLaAcGBcAALBTyFWK3GVwqtQ54fsc9jRrTK4xtIoGzgHfsO2cM13X7UruwPFpPHbsAAAqgzbOHk393W63l0EBZvfOAW3g36s8Uvr6vscg9MDwAwOM2ae87b0tgDywcgEAAAeBVjGcc+MqBlyljg0NpvbiDqXBV1Ygb8eDNmyTjPV9j8E7WBUYFwAAMJNhGD7mqnS9Xsf9GMb8HpTiVKljwjdL73kVih9R65yDgXEgsGEbbAGMCwAAmIm1tnjQpT3btq1p2zbrngu6gI8GDlueKlWS75+fn5fn6dKuGgesNGA/wn4GGBjHgzZsG2N2t2E7xh5OTAPzgHEBAKiWpQZIfMMrGQc5YTdN8/Ihd6cS6OjaT54qxVdJ+AAmB8ojhXGkAfaSUB055w4zk0wGrTH7duOqHToJijjKagW/nR4cGxgXAACwIKUdIw22+QbzKQM3earUmgaGtfZtr0CuW9bPz8/LqUi8vLhhdnY3r+/vb2OtPcxsMgeX7O0T2lvBDXbsrQBbAOMCAAAKIfclSd/3xTPw/Hl+Ks8UyHWF3LTWWMWQg34aHFtrkwbB7XYzz+dzXGFpmmY0LsgnvAbatjXP5/Ow+eWX7ME9ah/QXSnU/o+yWgFOigcAgMpwznljjHfOFb/b9703xiQ/fd9Hw7HWvr3jnPPW2knpiqXTWjs7PELLH48rJz1aGVJ5WGuTZXd0nHP+crlsnYzZpOocfAbenpbQHVsxRy+DfYGVCwAAKEDOBsp9Et77LFcE7rpAs/ZL7j+QG76XuHyP3GDkPoHr9Zp0laEVivv9/vI8wfN+5hlXumvgiO5QEqpDXOy4Hbfb7WX178hyRfJ05DyA3/xz6wQAAMAR0QaIcoBNNxzHWHvzYtd1o8sEuUtN6byHYRiNIHqfvjPGvJxKc7vdXvIO3/zfDMMwltPlctk4NfMhOXDOja444DNQmzbmtw7J0TUAfAqsXAAAwARoTwM/6cmY3zPTJSsP3vuXwdkafvjyGNHSwT6dlU/v8/0S2glXtFLC/65pT0UIyr9zzvz69Wvj1CwD7b8wBkbkp+CGxZQT5gBYGxgXAACwAHzgyP+NwQcIax/Fyjd7y8F/DHLjodOseL745VzG/MmH5ioWc3UiI+XsUB2fze2j6zps8P4Q0rB4PB6ndiMExwTGBQAAFMDvJyA3EOnalHt3wafPc79ery9H1ubc7P14PIz3fhwQ84ExHSlL4dHfj8ejaABdw6oGl5szQm45Z83fHuAriEffXxEC8nMOYFwAAMAE+r4fB+Y0a0uUdPpbzPSSQUArGSWbcXmeKZ+Ud8yghqlhsyrJQe6qGMiH79c546EHPz8/WycBLAiMCwBAdcwZ4PEOPuTWRIOr1MoAvxeDLqb71MydXHHINXIofVM3kH5/f0fDPSNnX7Ugrtfr2CbgHrUc3BXqjIaFMcY8n8+tkwAWBMYFAABkEhskkpsUDQKapom6+5BBQs90Xffy7Cc2x8qN3qkBIW1Wp03h9KH3S+Dxyndvt9spb+k+86oFAfeoZanBsAAnZKP7NQAAYFPMhMuaDLuQji680y58M+KCOAldFmUCl+2ZD1+IJS+409DyEstjLIycz1ku06vxYrAa87wWn9YFW/H19VVFPmsBKxcAAJAJX4l4PB6m6zp1JtGzU5XkDC4/fSk0E0nvf2qmm19qp804k7+3F/cYlF76Z601l8vF9H0/XjYY+oTK9misfQrYHuH3X5xt9emTkHvlWTdvgxOzkVEDAACbYjBL9oa19mV1BsyDVoRqLE9avagx73Pp+35si7XoKKxcnAusXAAAqoNOJsEmwle6rjP3+x33FSzE33//bYwx5t///vfGKfk8j8djXKXCSUBl/P3336bve3O5XKpZsfjPf/6zdRLAgjTei3VuAACogNvtNrrngFe4Owa5JtEZ+2dwVVqTYRjGMqJyrFXG+GZkKoO2basZMOfw8/Nj/vvf/760M3JNrElu/vrrL/P9/V1Vns8MVi4AAFUwDMN4uhEf9ND3OJv/D55dDjgMw7jnosb9AyWQAUZlZkzdpyZxQ3QYhpeBM/iNc+7lrhl+1HUN8FPhuE7Gyumx+efWCQAAgE/B73Ug+F0V4A+06fzTt4ifAVlmwzBUuylXkyOsXrwjdVItK4Rc71prxxVlAnJyTLByAQCoAn4iEogTmjWsZTZ1SeiyxZx7RM7CMAymaZrgpZAwWONQmdV20pa8VBSGxXHBygUAoBpigxp0ZL+RM4ccGBfl1DgLSzd1h+Sllln5qXA9dfY9CCE5gQF6bLByAQCohtCgBh3ZH+AKNZ2Q8WCtPf0gUdJ1HeRoJjUY85qMYNXi+MC4AABUhdZhw13qD9frFQPDhalVvmrN91xoNr+GFR7NiIDcHB8YFwCAqtA67Bo68VJgYCxDTZtzJdfrtboVm7k4505zO30utW5mPzO73nNBJ2yAdaCNhgDUzu12Q1vIZK2yos2cR5+1lD7k1tpqNnLngvL4g7xgsMYxD88zLvD8g1zVKS2X3PfXMOh2fYkezsQGAAAAAABgXZY0B3a9ciGhGSFr7cvMGWbg4/Dy4Ue9GaOf1HAUg442nn6i7mW5EZ+Kfy9w2dibnITqKETsNJvc99es+znlu0bdrF3fXEfx7+gYV/nsnLLX9OCS4XG0sEtldWnmyr6sj1LZmCNLqbrbm14CoEr8jnHOeWOM33kyDweVqXNu66QcCmtt9WVH+Ueb3B9nkU3I2Dacpb/l+ej7fuvkHB7e7x25PNF/v9P3/Wr6Fhu6AcikphUKAAA4OtgYPB/e7x25POWmcbBufcK4AAAAAAAAVXBkI+kowLgAAACwOzC7CAAAxwTGBQCgGAz8AAAAgGOzVl9epXExDINp29a0bWuGYVB/v91uOGt5IrfbzTRNs0n53W43tU6JVN1vAaUnVV5t25qmaZJ5/ASlJ820bWu+v7+NMX/qgKC/t87Tp5HlkCMDa0BlnyuHKUh/kqxODS9XxoZheJOdqbJ0NlmU7WztfJGOmqv/P62jednsUQbW1A1rygXXKXPjWDKsNaBy3Gv6Qqx2at2i28MXZq3TK3i4WthrxWut3cVpC2blExP4qQzP51N9pu/7VeJP1Vuq7mPwd5dKuzytwVobfJY/t9VpF1PKTpa5zEOtp3hoZWJmnMgypQxDdTNH98XquvT9HLj8zGkja7TvLaFysdZmnaA0t9+T9RDTZSXhlLaJ0nyE2sDU9C/NUu1ShiflIiTzU+VCq8epZZrqQ0rDWIM5Y4slKS2btdJc5crF4/GIXhbCbzVc0gI9w+2zOXRdNy61PZ9P9Rnt7PolcM5FLfFU3X+a6/VqvPdjmmNp5+e7H1WOtCVYLi814px7qc8t7j9wzhnv/ctnCjS7aq19kes15ZWX15x4Ho/HqW5H5jpF3oC8NE3TjPcpkfx0XVccTtu2L+GQXviUftijHlpr3LDmXSvDMIxhe+/H9M+Nj8YNfd8b7/3bDdRbwu9hM2a7W+iprLceIxzqEr0YXJglU642J0Ghi9pCYXEBot94Wh6Px8vf8mp7rXFoeZnz3BKEGkoovtglTdIVhL8j6yk3j3t0YQulSctnjnzyZ2KdoFZmIbmV9TSlraQo6bA1mcmpb5nukD4I5W9qeFPTx5GXgO5xgJOLNCau1+soY8MwrHJKCzfOHo9HtFNN6RNKX6r9cHhb0p6hOCmekP6n7+VzPFzZt8h35ff0Pm/nS8sXxe2cm93/UH9Lddh1nWnb9mMDpa7rTNM0xhi9nDSdLutBuwwy97lQ33C9XrPKINWf0vc0tnk8HtH8TkXqAcq7c860bTtZTqy1mxgUsr+M9eHSyMgJUxv30HdSL8TCoudK2svcCzWDLLoOsjAly1ix5f3Qkmos7Fh4fLlJu2BGLjXGwpLx5y7RSneaUHixfE91VQiVhZaPr6+vt3SH3BhkeCVLobGyiuWnhFK3iSXlUT4Xij9HzkrkMRZ+CcYYf7/fX+SWE0uTrM+cci3RB3NkUauL0uekjpjKlHat5WuO+2asbtdappdlFyqHXL2TKzc57lgxPc2fTbVJilt7N9R+KX258jVVBnkaKa6paPVG6cqlNB9SJ5XKT24dUrtKPZfS7ak858qtlJ+lytP79zLl8U7RLUvoqbn5yK2nlLyG5IjnpSTOUHi5LmhruYudzrgggcsp4NzGSpXOw9W+i4Udei4Vp/fvyoA/qxk6KVKNQ8NaqyrHlP+uNC5kGlLKQf4ea7jccEkxpTGVGhfk00r/nyOP8rlUB6TJBY+bKyT5XSxvXHmV0Pf9uP+GZIkTam8h2XfOjc/F2gf/PtQGSabl5MCc8DRDR5Yr5Y+YuydrSrvmeXDOqXIxJQ2ctY0LyoPUybwsZT4JTXZinb3MU6gvkAYGL1euR2OGLsk5f07rg0JpluWgtTvOXOMiNlgqCevTxoX3r7pakx/6PqUntHrm9U/lz5+jPjLVv8TyxOOUfY6mn3j+SsYlJYQMninEBvm5cjYlH3xcKfXjFONCjlM12fBe1wNavLLeZZmvVS45nMa44JAgpiy3WNixAYEMmwsMfyY0UxlCCjJ9NCUhG1vJjNGUQQgnZwYi17hIIfOfem9PxoV8b448yue0+EvkJ6QAU3mb20mECJWRNoDX8iXTHTKAtbTzsgrVcWpQJ9OsyeycGd0cloontw3F0sBZ27jIIabP5SBfk0Op8/iAQGtroQFyTAeEZEwin8nt71LMNS74wHZq/cXKLpe1BkskK7l6R8K/1+qMT9xpdRkKV+osTZfF5ElOhsTCL0Hqv7l1ItOZMxnGmZIPqhP6f06cIXnl74cmFfgEnIxHyluo3Zfmc+6EUojT7LkghmEYfd3cDD9NejfHD5F83KSf4f1+nxR3LzZaObHvw5jf/n30HP9QOtbwbZZlu/Ytl7fb7a1MU3W6mv/gRIZhMN/f38ZaO2mDYwjuw639ppVBbnuIhb0WfcAfXMqY9L8O+TfzcGJyqskYyRAvBx5GLDzeRriv+55kMsUSbUjbX1Hq073G3hNNvubosdK6jeUpV8a896ZpmnHTc65uXBuu35w4pKCEkP5Za89ODrJdc3h6tbGHlm5N3y2RtyllvkaZ8v0EJBdUhlP3XGj6ZG29yvUDr9sp6ee6IqQHns+n+fXr15g3Hg+1ex6eMeZtXEHj0Vz9uVYZnuq0KK4AaIA99QxnaqShgpcVR8/TYMVaa379+lUcL8Xp2aktj8dj/BB0qsbj8TBd172cuLOGsMiypY3qa22kpvy5/59iQ/mncg7V6d4GcbLjD52BnVuO9K6WT6mI5CdXIa4xqMtF5kuWFW+X/v8n0mjpze0wKT6S6cfjMeuEGt4BdV03ts+zwO/D0NDKjOpsyqEaS5PSDyRvMu5QWkg/TW1rU6H0kJ40Zp1B4lRyy7mELfMn2zU36rhscH1C0DgkFN7Pz8/b91Nln4w6mmQkedyq7GL6QPL9/b3b+yFut5sx5o9hERtXUt2H6pyeIRnik8KxCelQfFIXx8YIH2XRdZCFKVneCbkJGfPu3qC5P/ClcRmW5m+nLSPK+EO/y6VLbdlNLrfLctDiWXPPRahseXy8bCkt9/s96lusuRV4H/dNpO9j8co6lc+F6j5GyGVGg8sQlUGpPMrwcp7TykerK215Nse9gsvBkmjtTXMTkX+HZEJzCYiFR/GF2nnKLUoLT0tf6N6XJctwSrumd1I6N1X/stw1f+I18pGC6xNe17JN8jYQc8EIyZfmziC/D+maVNvmyD4qR3/lllFp25Z1zMs6Fkfsd7k3oUR+puYjhkwzj4OXv/xe6hPNzeVyuUTHF9xdKiQbWjlxGZ8jH1PKU5OBWF1q7YnnQ7bJmIvRkvng6ab3Uv0kxRP7TXNl4v2DJi8hXRXqp3LzuVqfvmhoC1MiDLJRywZOaL7QKcURC09LQ0roQvESoXi1zk77pJgzCInFJwU7lsfYs9rAMVYPuXWVU/cxphoXsXqMpZ2XbW7aY/FqAyMeR44MraGIStpbLH8hmdDyrSno3DLTvsvVHff7fbFyk0xp16H0hsLIqX9NVksGN1PykUNOm0zVvTZYioUXkwduaObKv1ZOc/daEHMG5Sk9R4QmAwg5iUTPlcjPGsbFFD2RqsfQcznPyGdT6fu0ceF9uH2k4tDkvbRtLJmPueVf0n99fX29PMPbiBav1E1TyidVN1M5zZ4L6X9HS5FyObDrurfv6exwWrbSXJB4PLHz6ikODQo3dFY54b1/W+qSz1EcqTszloKnKRQPXQjH+fn5Ud3D6NlY+umMc2Pi5S7jDMHrhZYO11oupj0xxrz65ErZK0m7TLOWBypXLmOy7Mj1h8s8pXMLuCuSvCdGpp3vNSLoGV62mrzyfPO9FDI8ra64bPLwZBp5HFp4//rXv2aU1PKQTsrVIzl7DHi7NWb63Skh3/upaDpHpi0kN/x5QtPB8nku25QffscBj1c72z5WdiRnbgcXaqZ0DsFlQ6vb6/X6Jj97uCgtpCfk2IH/6yLugKS73f/dbEJl4pjvvGx3cr9GqG1uVX6yHmNp4eWluVJpeZuqV0oJlass/5x2qPXPPDzqx7SwtO+0O212w6KmysKsMQOxBtJdZe+YAqsW/KFk5eKsmJVmOcB8ziKbkLEwmnvkUhypD4uxZT4o3tRq0hR3r62AXJybtfTtaVYutoLv3ifm3EAJAABgZ7NwOyB0U3XTNNkroGA9+Cx93/emaRr1ZCG+Cb/ve/PXX3+Zr6+vj6YVgLWBcTETn1hmBwAAUA6Mi1c0lzv6HmyPVg/ad9wFyJjpR9YDsGdgXCwAlDsAAIC1mXsvB1iXnLEA6hDUwKnuuQAAAAAAAABsB4wLAAAAAAAAwCLAuAAAAAAAAAAsAowLAEAx2GwL1mare1cAAKAW1urLD2FcYCAD9gYGPgAsD10uZgzaGJgPlycAwOdo/I4PyA6d6w0AAEdnKd0GHTkfa+3bEaHGTCvbNerDObdouEvkEyzD/X43l8tlsfBSdZuq67nv7xV+0za199qRdbmkOQDjAgAAAAAAgIpZ0hzY9T0X2kwSAAAAAAAAJfDVC2PeVzBSv3+atce/a4a/65ULAAAAAAAAwHE4xIZuAAAAAAAAwP6BcQEAAAAAAABYBBgXAAAAAAAAgEWAcQEAAAAAAABYBBgXAKspO0YAAAAtSURBVAAAAAAAgEWAcQEAAAAAAABYBBgXAAAAAAAAgEWAcQEAAAAAAABYhP8BAB9NJ6vuxwAAAAAASUVORK5CYII=" alt="image-20210305155921535"></p> <p>如果是skiplist编码，使用zset结构：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">zset</span><span class="token punctuation">{</span>
    zskiplist <span class="token operator">*</span>zsl<span class="token punctuation">;</span>
    dict <span class="token operator">*</span>dict<span class="token punctuation">;</span>
<span class="token punctuation">}</span> zset<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>dict字典为有序集合创建了一个从成员到分值的映射，字典中的每个键值对都保存了一个集合元素：键保存元素，值保存分值。通过字典以O(1)查找给定成员的分值。有序集合元素都是字符串对象，分值都是double类型浮点数。zset的跳跃表和字典通过指针来共享相同元素的成员和分值，不会浪费额外内存。</p> <p><img src="/person-log.io/assets/img/image-20210305160240826.87b020d7.png" alt="image-20210305160240826"></p> <p>当有序集合对象同时满足以下两条件时，对象使用ziplist编码：</p> <ul><li>有序集合保存的元素数量**&lt;128个**</li> <li>有序集合保存的所有元素成员的长度<strong>都&lt;64字节</strong></li></ul> <p>否则使用skiplist编码。</p> <p>注：两条件的上限值可通过配置文件修改。</p> <h2 id="类型检查与命令多态"><a href="#类型检查与命令多态" class="header-anchor">#</a> <strong>类型检查与命令多态</strong></h2> <p>Redis中用于操作键的命令可分为两种类型。一种是可对任何类型执行的，如del，expire，rename等。另一种命令只能对特定类型的键执行，如set，get，hdel，hset，rpush等。如果对特定类型使用其他类型的命令，那么就会报错。</p> <h3 id="类型检查的实现"><a href="#类型检查的实现" class="header-anchor">#</a> <strong>类型检查的实现</strong></h3> <p>为了确保只有制定类型的键可以执行某些特定命令，在执行前，Redis会先通过RedisObject的type属性检查输入键的类型是否正确。</p> <h3 id="多态命令的实现"><a href="#多态命令的实现" class="header-anchor">#</a> <strong>多态命令的实现</strong></h3> <p>Redis除了根据值对象判断键是否能够执行制定命令外，还会根据值对象的编码方式，选择正确的命令实现代码来执行。比如基于编码的多态，列表对象的编码可能是ziplist或linkedlist，所以需要多态命令执行对应编码的API。基于类型的多态是一个命令可以同时处理多种不同类型的键。</p> <h2 id="内存回收"><a href="#内存回收" class="header-anchor">#</a> <strong>内存回收</strong></h2> <p>refcount,引用计数器还有共享对象的作用。如果两个不同键的值都一样（必须是整数值的字符串对象），则将数据库键的值指针指向一个现有的值对象，然后将被共享对象的引用计数加一。如果不是整数值的对象，则需要耗费大量的时间验证共享对象和目标对象是否相同，复杂度较高，消耗CPU时间，所以Redis不会共享包含字符串的对象。</p> <p>Redis在初始化服务时，会创建很多字符串对象，包含0~9999的整数（和Integer的常量池有点像），当需要时，就能直接复用。</p> <h2 id="对象的空转时长"><a href="#对象的空转时长" class="header-anchor">#</a> <strong>对象的空转时长</strong></h2> <p>redisObject还包含了lru属性，记录对象最后一个被命令程序访问的时间。<code>object idletime</code>命令可打印键的空转时长，就是<strong>当前时间减去lru时间</strong>计算得到的。</p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/caizongkai/vuepressDemo/edit/main/docs/md/database/Redis/数据结构与对象/Redis-07-对象.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <!----> </div> <!----></div></div>
    <script src="/person-log.io/assets/js/app.900e0138.js" defer></script><script src="/person-log.io/assets/js/8.f33fb86b.js" defer></script>
  </body>
</html>
