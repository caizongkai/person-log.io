(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{239:function(t,e,_){t.exports=_.p+"assets/img/image-20210128163351568.e4671354.png"},240:function(t,e,_){t.exports=_.p+"assets/img/image-20210128163539552.b6f854cf.png"},241:function(t,e,_){t.exports=_.p+"assets/img/image-20210128163634171.ef9e2b0d.png"},242:function(t,e,_){t.exports=_.p+"assets/img/640.04ec9b15.gif"},243:function(t,e,_){t.exports=_.p+"assets/img/image-20210128164103327.6f4a8586.png"},244:function(t,e,_){t.exports=_.p+"assets/img/image-20210128164512793.7da1f307.png"},245:function(t,e,_){t.exports=_.p+"assets/img/image-20210128164614202.30a122be.png"},246:function(t,e,_){t.exports=_.p+"assets/img/image-20210128165207389.7fe493ba.png"},247:function(t,e,_){t.exports=_.p+"assets/img/image-20210128165439199.642a07ed.png"},248:function(t,e,_){t.exports=_.p+"assets/img/image-20210128170652931.33e0c407.png"},249:function(t,e,_){t.exports=_.p+"assets/img/image-20210128170850889.466b0c9d.png"},250:function(t,e,_){t.exports=_.p+"assets/img/image-20210128170923690.6d831a0f.png"},251:function(t,e,_){t.exports=_.p+"assets/img/image-20210128170949947.e2e1cf95.png"},252:function(t,e,_){t.exports=_.p+"assets/img/image-20210128171808106.879de3a6.png"},288:function(t,e,_){"use strict";_.r(e);var v=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"content"},[e("h1",{attrs:{id:"图解网络"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#图解网络"}},[t._v("#")]),t._v(" 图解网络")]),t._v(" "),e("h2",{attrs:{id:"集线器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#集线器"}},[t._v("#")]),t._v(" 集线器")]),t._v(" "),e("p",[t._v("最初，我们要发送信息给一个电脑，我们需要用一根线把两个电脑连起来，就像下图：")]),t._v(" "),e("p",[e("img",{attrs:{src:_(239),alt:"image-20210128163351568"}})]),t._v(" "),e("p",[t._v("但是当电脑越来越多，我们就无法通过这种方式将电脑两两连接起来，如下图：")]),t._v(" "),e("p",[e("img",{attrs:{src:_(240),alt:"image-20210128163539552"}})]),t._v(" "),e("p",[t._v("于是我们就发明了"),e("strong",[t._v("集线器")]),t._v("，把所有的电脑都连到一个设备上，然后通过这个设备做转发，如下图：")]),t._v(" "),e("p",[e("img",{attrs:{src:_(241),alt:"image-20210128163634171"}})]),t._v(" "),e("p",[t._v("这样线就不会那么混乱了，"),e("strong",[t._v("集线器")]),t._v("是直接将传入的电信号无脑转发到所有端口，不做任何处理，由于集线器智商太低，所以我们给他定义在"),e("strong",[t._v("物理层")]),t._v("。就像下图：")]),t._v(" "),e("p",[e("img",{attrs:{src:_(242),alt:"640"}})]),t._v(" "),e("p",[t._v("那么集线器没有做任何处理，电脑是如何知道这个信息是发给自己的呢？这个时候我们需要给电脑起一个唯一的名字，叫"),e("strong",[t._v("MAC地址")]),t._v("。")]),t._v(" "),e("p",[t._v("A的 MAC 地址是 aa-aa-aa-aa-aa-aa，你的伙伴 b 的 MAC 地址是 bb-bb-bb-bb-bb-bb，以此类推，不重复就好。")]),t._v(" "),e("p",[t._v("这样，A 在发送数据包给 B 时，只要在头部拼接一个这样结构的数据，就可以了。")]),t._v(" "),e("p",[e("img",{attrs:{src:_(243),alt:"image-20210128164103327"}})]),t._v(" "),e("p",[t._v("B 在收到数据包后，根据头部的目标 MAC 地址信息，判断这个数据包的确是发给自己的，于是便"),e("strong",[t._v("收下")]),t._v("。")]),t._v(" "),e("p",[t._v("其他的 CDE 收到数据包后，根据头部的目标 MAC 地址信息，判断这个数据包并不是发给自己的，于是便"),e("strong",[t._v("丢弃")]),t._v("。")]),t._v(" "),e("p",[t._v("但是这时候就出现了，其他电脑并不需要这个信息，但是还是会接收到信息的情况，那么这样不仅不安全，而且还浪费资源。那么有什么更好的办法可以解决呢？答案是"),e("strong",[t._v("交换机")]),t._v("。")]),t._v(" "),e("h2",{attrs:{id:"交换机"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#交换机"}},[t._v("#")]),t._v(" 交换机")]),t._v(" "),e("p",[t._v("交换机比集线器更智能，"),e("strong",[t._v("只发给目标 MAC 地址指向的那台电脑")]),t._v("。也正因为这一点点智能，你把它放在了另一个层级，"),e("strong",[t._v("数据链路层")]),t._v("。")]),t._v(" "),e("p",[e("img",{attrs:{src:_(244),alt:"image-20210128164512793"}})]),t._v(" "),e("p",[t._v("如上图所示，你是这样设计的。")]),t._v(" "),e("p",[t._v("交换机内部维护一张 "),e("strong",[t._v("MAC 地址表")]),t._v("，记录着每一个 MAC 地址的设备，连接在其哪一个端口上。")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("MAC 地址")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("端口")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("bb-bb-bb-bb-bb-bb")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("1")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("cc-cc-cc-cc-cc-cc")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("3")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("aa-aa-aa-aa-aa-aa")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("4")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("dd-dd-dd-dd-dd-dd")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("5")])])])]),t._v(" "),e("p",[t._v("假如你仍然要发给 B 一个数据包，构造了如下的数据结构从网口出去。")]),t._v(" "),e("p",[e("img",{attrs:{src:_(245),alt:"image-20210128164614202"}})]),t._v(" "),e("p",[t._v("到达交换机时，交换机内部通过自己维护的 MAC 地址表，发现"),e("strong",[t._v("目标机器 B 的 MAC 地址 bb-bb-bb-bb-bb-bb 映射到了端口 1 上")]),t._v("，于是把数据从 1 号端口发给了 B，完事~")]),t._v(" "),e("p",[t._v("你给这个通过这样传输方式而组成的小范围的网络，叫做"),e("strong",[t._v("以太网")]),t._v("。")]),t._v(" "),e("p",[t._v("当然最开始的时候，MAC 地址表是空的，是怎么逐步建立起来的呢？")]),t._v(" "),e("p",[t._v("首先这个包由A进入到交换机，那么我们就知道了A的端口和MAC地址的映射信息，我们就在MAC表中记录A的信息。然后由于在MAC表中无法找到目表MAC地址，这时候交换机会进行广播，将该包发送到所有端口，这时候只有B收到并且做出响应，这时候交换机就知道B的MAC地址，并将他记录到交换机的MAC表中。过程如下")]),t._v(" "),e("p",[t._v("![640 (1)](图解网络.assets/640 (1).gif)")]),t._v(" "),e("p",[t._v("随着机器数量越多，交换机的端口也不够了，但聪明的你发现，只要将多个交换机连接起来，这个问题就轻而易举搞定~")]),t._v(" "),e("p",[e("img",{attrs:{src:_(246),alt:"image-20210128165207389"}})]),t._v(" "),e("p",[e("strong",[t._v("左边的交换机")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("MAC 地址")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("端口")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("bb-bb-bb-bb-bb-bb")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("1")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("cc-cc-cc-cc-cc-cc")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("3")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("aa-aa-aa-aa-aa-aa")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("4")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("dd-dd-dd-dd-dd-dd")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("5")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("ee-ee-ee-ee-ee-ee")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("6")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("ff-ff-ff-ff-ff-ff")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("6")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("gg-gg-gg-gg-gg-gg")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("6")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("hh-hh-hh-hh-hh-hh")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("6")])])])]),t._v(" "),e("p",[e("strong",[t._v("右边的交换机")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("MAC 地址")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("端口")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("bb-bb-bb-bb-bb-bb")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("1")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("cc-cc-cc-cc-cc-cc")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("1")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("aa-aa-aa-aa-aa-aa")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("1")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("dd-dd-dd-dd-dd-dd")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("1")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("ee-ee-ee-ee-ee-ee")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("2")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("ff-ff-ff-ff-ff-ff")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("3")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("gg-gg-gg-gg-gg-gg")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("4")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("hh-hh-hh-hh-hh-hh")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("6")])])])]),t._v(" "),e("p",[t._v("但是很快，电脑越来越多，这种方式也不适用了，那么这个时候"),e("strong",[t._v("路由器")]),t._v("出现了。")]),t._v(" "),e("h2",{attrs:{id:"路由器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#路由器"}},[t._v("#")]),t._v(" 路由器")]),t._v(" "),e("p",[t._v("那我可不可以让那根红色的网线，接入一个"),e("strong",[t._v("新的设备")]),t._v("，这个设备就跟电脑一样有自己独立的 MAC 地址，而且同时还能帮我把数据包做一次"),e("strong",[t._v("转发")]),t._v("呢？这个设备就是"),e("strong",[t._v("路由器，"),e("strong",[t._v("它的功能就是，作为一台独立的拥有 MAC 地址的设备，并且可以帮我把数据包做一次转发")]),t._v("，"),e("strong",[t._v("你把它定在了")]),t._v("网络层。")])]),t._v(" "),e("p",[e("img",{attrs:{src:_(247),alt:"image-20210128165439199"}})]),t._v(" "),e("p",[t._v("注意，路由器的每一个端口，都有独立的 MAC 地址")]),t._v(" "),e("p",[t._v("那么如上图，路由器是怎么做到将A的包发送给B和C呢，这个时候单纯通过MAC地址是无法实现的。因为你无法通过MAC地址知道两台电脑是否连到同一个交换机上。这个时候我们就需要引入一个编号，来确定两台电脑是不是连接到同一台交换机上，这个编号有32位，如："),e("strong",[t._v("11000000101010000000000000000001")])]),t._v(" "),e("p",[t._v("你觉得有些不清晰，于是把它分成四个部分，中间用点相连。")]),t._v(" "),e("p",[e("strong",[t._v("11000000.10101000.00000000.00000001")])]),t._v(" "),e("p",[t._v("你还觉得不清晰，于是把它转换成 10 进制。")]),t._v(" "),e("p",[e("strong",[t._v("192.168.0.1")])]),t._v(" "),e("p",[t._v("最后你给了这个地址一个响亮的名字，"),e("strong",[t._v("IP 地址")]),t._v("。现在每一台电脑，同时有自己的 MAC 地址，又有自己的 IP 地址，只不过 IP 地址是"),e("strong",[t._v("软件层面")]),t._v("上的，可以随时修改，MAC 地址一般是无法修改的。")]),t._v(" "),e("h3",{attrs:{id:"子网"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#子网"}},[t._v("#")]),t._v(" 子网")]),t._v(" "),e("p",[t._v("这时你如何判断两台电脑是否连到同一台交换机上呢？我们称连在同一台交换机上的计算机属于同一个"),e("strong",[t._v("子网")]),t._v("。那么如何判断计算机是否连在同一个子网上呢？人们发明了"),e("strong",[t._v("子网掩码")]),t._v("的概念，即将IP地址和子网掩码做与运算，如果与运算的结果相等，那么我们就说这两台计算机在同一个子网，假如某台机器的子网掩码定为 255.255.255.0，比如")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("A电脑")]),t._v("：192.168.0.1 & 255.255.255.0 = 192.168.0.0")]),t._v(" "),e("li",[e("strong",[t._v("B电脑")]),t._v("：192.168.0.2 & 255.255.255.0 = 192.168.0.0")]),t._v(" "),e("li",[e("strong",[t._v("C电脑")]),t._v("：192.168.1.1 & 255.255.255.0 = 192.168.1.0")]),t._v(" "),e("li",[e("strong",[t._v("D电脑")]),t._v("：192.168.1.2 & 255.255.255.0 = 192.168.1.0")])]),t._v(" "),e("p",[t._v("那么 A 与 B 在同一个子网，C 与 D 在同一个子网，但是 A 与 C 就不在同一个子网，与 D 也不在同一个子网，以此类推。子网掩码其实是确定ip地址前几位相同就将他定义为在同一个子网。")]),t._v(" "),e("p",[e("img",{attrs:{src:_(248),alt:"image-20210128170652931"}})]),t._v(" "),e("p",[t._v("那么现在网络拓扑图如上，这个时候A给B发信息，我们除了需要在包上加上数据链路层的头部之外，还需要再增加一个网络层的头部。")]),t._v(" "),e("p",[e("img",{attrs:{src:_(249),alt:"image-20210128170850889"}})]),t._v(" "),e("p",[t._v("但假如 A 给 C 发送数据，A 就需要先转交给路由器，然后再由路由器转交给 C。由于最底层的传输仍然需要依赖以太网，所以数据包是分成两段的。")]),t._v(" "),e("p",[t._v("A ~ 路由器这段的包如下：")]),t._v(" "),e("p",[e("img",{attrs:{src:_(250),alt:"image-20210128170923690"}})]),t._v(" "),e("p",[t._v("路由器到 C 这段的包如下：")]),t._v(" "),e("p",[e("img",{attrs:{src:_(251),alt:"image-20210128170949947"}})]),t._v(" "),e("p",[t._v("因为A给B发送信息时，发现A和B在同一子网，那么这时候A将包丢给交换机，然后交换机转发包给B，如何转发可以看交换机那一部分。")]),t._v(" "),e("p",[t._v("当A给C发送信息时，发现A和C不在同一子网，那么这时候我们就要通过交换机把包先丢给路由器，那么这时候我们怎么知道哪个是路由器呢？那么另一个概念就来了，就是"),e("strong",[t._v("默认网关")]),t._v("。")]),t._v(" "),e("h3",{attrs:{id:"默认网关"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#默认网关"}},[t._v("#")]),t._v(" 默认网关")]),t._v(" "),e("p",[t._v("前面我们说了，路由器是相当于一个电脑的，当源IP地址跟目标IP地址不在同一子网，那么这时候我们需要告诉发送包的电脑哪个是路由器，这个路由器有一个IP地址，叫做"),e("strong",[t._v("默认网关")]),t._v("。这时候上面的网络拓扑图如下：")]),t._v(" "),e("p",[e("img",{attrs:{src:_(252),alt:"image-20210128171808106"}})]),t._v(" "),e("p",[t._v("当A给C发送包时，发现A和C不在同一子网，那么这时候A就把包丢给默认网关，也就是路由器，但是交换机需要知道路由器的MAC地址才能将包发送给路由器，那么只知道我的目标IP地址，怎么让交换机把包发送到目的地呢？答案是"),e("strong",[t._v("arp")]),t._v("。")]),t._v(" "),e("h3",{attrs:{id:"arp协议"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#arp协议"}},[t._v("#")]),t._v(" arp协议")]),t._v(" "),e("p",[t._v("电脑里面有一张 "),e("strong",[t._v("arp 缓存表")]),t._v(",有一张 "),e("strong",[t._v("arp 缓存表")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("IP 地址")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("MAC 地址")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.0.254")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("ABAB")])])])]),t._v(" "),e("p",[t._v("一开始的时候这个表是"),e("strong",[t._v("空的")]),t._v("，电脑 A 为了知道路由器（192.168.0.254 ）的 MAC 地址，将会"),e("strong",[t._v("广播")]),t._v("一条 arp 请求，路由器收到请求后，带上自己的 MAC 地址给 A 一个"),e("strong",[t._v("响应")]),t._v("。此时 A 便更新了自己的 arp 表。这样通过大家不断广播 arp 请求，最终所有电脑里面都将 arp 缓存表更新完整。")]),t._v(" "),e("p",[t._v("此时包就成功丢到了路由器上了。那么路由器是如何将包发出去的呢？答案是通过"),e("strong",[t._v("路由表")]),t._v("。")]),t._v(" "),e("h3",{attrs:{id:"路由表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#路由表"}},[t._v("#")]),t._v(" 路由表")]),t._v(" "),e("p",[t._v("路由器收到的数据包有目的 IP 也就是 C 的 IP 地址，需要转化成从自己的哪个端口出去，很容易想到，应该有个表，就像 MAC 地址表一样。")]),t._v(" "),e("p",[t._v("不同于 MAC 地址表的是，路由表并不是一对一这种明确关系，我们下面看一个路由表的结构。")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("目的地址")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("子网掩码")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("下一跳")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("端口")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.0.0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("255.255.255.0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.0.254")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("255.255.255.255")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("255.255.255.0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("1")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.254")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("255.255.255.255")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("1")])])])]),t._v(" "),e("p",[t._v("我们学习一种新的表示方法，由于子网掩码其实就表示前多少位表示子网的网段，所以如 192.168.0.0（255.255.255.0） 也可以简写为 192.168.0.0/24")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("目的地址")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("下一跳")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("端口")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.0.0/24")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.0.254/32")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.0/24")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("1")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.254/32")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("1")])])])]),t._v(" "),e("p",[t._v("通过路由表，路由器收到了来自A的包，然后知道目标的ip地址，那么路由器就会将包发送给目标ip的交换机，通过查路由表就知道这个包需要从哪个端口发出去，当无法查到对应的子网，那么就会通过下一跳去各种检索，这个我也不太懂，就不展开讲了~然后最后发现还是无法找到目标ip地址的交换机，就会超时，包不可达。")]),t._v(" "),e("p",[t._v("但是如上面的示例，路由器通过查路由表可以找到目标IP的子网交换机，这个时候就会将包通过对应端口转发出去，这时候交换机收到来自路由器的包，通过MAC地址表将包丢给目标电脑。")]),t._v(" "),e("h1",{attrs:{id:"总结一下"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#总结一下"}},[t._v("#")]),t._v(" "),e("strong",[t._v("总结一下")])]),t._v(" "),e("p",[t._v("好了，总结一下，到目前为止就几条规则")]),t._v(" "),e("p",[e("strong",[t._v("从各个节点的视角来看")])]),t._v(" "),e("p",[e("strong",[t._v("电脑视角")]),t._v("：")]),t._v(" "),e("ul",[e("li",[t._v("首先我要知道我的 IP 以及对方的 IP")]),t._v(" "),e("li",[t._v("通过子网掩码判断我们是否在同一个子网")]),t._v(" "),e("li",[t._v("在同一个子网就通过 arp 获取对方 mac 地址直接扔出去")]),t._v(" "),e("li",[t._v("不在同一个子网就通过 arp 获取默认网关的 mac 地址直接扔出去")])]),t._v(" "),e("p",[e("strong",[t._v("交换机视角：")])]),t._v(" "),e("ul",[e("li",[t._v("我收到的数据包必须有目标 MAC 地址")]),t._v(" "),e("li",[t._v("通过 MAC 地址表查映射关系")]),t._v(" "),e("li",[t._v("查到了就按照映射关系从我的指定端口发出去")]),t._v(" "),e("li",[t._v("查不到就所有端口都发出去")])]),t._v(" "),e("p",[e("strong",[t._v("路由器视角：")])]),t._v(" "),e("ul",[e("li",[t._v("我收到的数据包必须有目标 IP 地址")]),t._v(" "),e("li",[t._v("通过路由表查映射关系")]),t._v(" "),e("li",[t._v("查到了就按照映射关系从我的指定端口发出去（不在任何一个子网范围，走其路由器的默认网关也是查到了）")]),t._v(" "),e("li",[t._v("查不到则返回一个路由不可达的数据包")])]),t._v(" "),e("p",[t._v("如果你嗅觉足够敏锐，你应该可以感受到下面这句话：")]),t._v(" "),e("p",[t._v("网络层（IP协议）本身没有传输包的功能，包的实际传输是委托给数据链路层（以太网中的交换机）来实现的。")]),t._v(" "),e("p",[e("strong",[t._v("涉及到的三张表分别是")])]),t._v(" "),e("ul",[e("li",[t._v("交换机中有 "),e("strong",[t._v("MAC 地址")]),t._v("表用于映射 MAC 地址和它的端口")]),t._v(" "),e("li",[t._v("路由器中有"),e("strong",[t._v("路由表")]),t._v("用于映射 IP 地址(段)和它的端口")]),t._v(" "),e("li",[t._v("电脑和路由器中都有 "),e("strong",[t._v("arp 缓存表")]),t._v("用于缓存 IP 和 MAC 地址的映射关系")])]),t._v(" "),e("p",[e("strong",[t._v("这三张表是怎么来的")])]),t._v(" "),e("ul",[e("li",[t._v("MAC 地址表是通过以太网内各节点之间不断通过交换机通信，不断完善起来的。")]),t._v(" "),e("li",[t._v("路由表是各种路由算法 + 人工配置逐步完善起来的。")]),t._v(" "),e("li",[t._v("arp 缓存表是不断通过 arp 协议的请求逐步完善起来的。")])])])}],a=_(0),i=Object(a.a)({},(function(){this._self._c;return this._m(0)}),v,!1,null,null,null);e.default=i.exports}}]);