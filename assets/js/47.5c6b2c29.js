(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{379:function(s,a,n){"use strict";n.r(a);var e=n(0),t=Object(e.a)({},(function(){this._self._c;return this._m(0)}),[function(){var s=this,a=s._self._c;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"dockerfile详解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile详解"}},[s._v("#")]),s._v(" Dockerfile详解")]),s._v(" "),a("blockquote",[a("p",[s._v("本文将围绕以下三点进行讲解")])]),s._v(" "),a("ul",[a("li",[s._v("什么是Dockerfile?")]),s._v(" "),a("li",[s._v("Dockerfile的基本结构")]),s._v(" "),a("li",[s._v("Dockerfile命令详解")])]),s._v(" "),a("h2",{attrs:{id:"什么是dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是dockerfile"}},[s._v("#")]),s._v(" 什么是Dockerfile")]),s._v(" "),a("p",[s._v("Dockerfile是用于构建Docker镜像的一个命令文件，编写好Dockerfile后，可以采用如下命令构建Docker镜像。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -f指定文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" REPOSITORY:TAG "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" /path/to/a/Dockerfile\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# .表示指定当前目录的Dockerfile")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" REPOSITORY:TAG "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"dockerfile基本结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile基本结构"}},[s._v("#")]),s._v(" Dockerfile基本结构")]),s._v(" "),a("p",[s._v("Dockerfile一般分为四部分：基础镜像信息、维护者信息、镜像操作指令和容器启动时指令，’#’ 为 Dockerfile 中的注释。")]),s._v(" "),a("h2",{attrs:{id:"dockerfile命令详解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile命令详解"}},[s._v("#")]),s._v(" Dockerfile命令详解")]),s._v(" "),a("p",[s._v("Docker以从上到下的顺序运行Dockerfile的指令。为了指定基本映像，第一条指令必须是"),a("em",[s._v("FROM")]),s._v("。一个声明以"),a("code",[s._v("＃")]),s._v("字符开头则被视为注释。")]),s._v(" "),a("p",[s._v("常用的命令如下：")]),s._v(" "),a("h3",{attrs:{id:"from"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#from"}},[s._v("#")]),s._v(" "),a("strong",[s._v("FROM")])]),s._v(" "),a("p",[s._v("指定基础镜像，必须为第一个命令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("格式：\n　　FROM <image>\n　　FROM <image>:<tag>\n　　FROM <image>@<digest>示例：　　FROM mysql:5.6注：　　tag或digest是可选的，如果不使用这两个值时，会使用latest版本的基础镜像\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"maintainer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#maintainer"}},[s._v("#")]),s._v(" "),a("strong",[s._v("MAINTAINER")])]),s._v(" "),a("p",[s._v("维护者信息")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("格式：\n    MAINTAINER <name>\n示例：\n    MAINTAINER Jasper Xu\n    MAINTAINER sorex@163.com\n    MAINTAINER Jasper Xu <sorex@163.com>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"run"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#run"}},[s._v("#")]),s._v(" "),a("strong",[s._v("RUN")])]),s._v(" "),a("p",[s._v("构建镜像时执行的命令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('RUN用于在镜像容器中执行命令，其有以下两种命令执行方式：\nshell执行\n格式：\n    RUN <command>\nexec执行\n格式：\n    RUN ["executable", "param1", "param2"]\n示例：\n    RUN ["executable", "param1", "param2"]\n    RUN apk update\n    RUN ["/etc/execfile", "arg1", "arg1"]\n注：　　RUN指令创建的中间镜像会被缓存，并会在下次构建中使用。如果不想使用这些缓存镜像，可以在构建时指定--no-cache参数，如：docker build --no-cache\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h3",{attrs:{id:"add"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#add"}},[s._v("#")]),s._v(" "),a("strong",[s._v("ADD")])]),s._v(" "),a("p",[s._v("将本地文件添加到容器中，tar类型文件会自动解压(网络压缩资源不会被解压)，可以访问网络资源，类似wget")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('格式：\n    ADD <src>... <dest>\n    ADD ["<src>",... "<dest>"] 用于支持包含空格的路径\n示例：\n    ADD hom* /mydir/          # 添加所有以"hom"开头的文件\n    ADD hom?.txt /mydir/      # ? 替代一个单字符,例如："home.txt"\n    ADD test relativeDir/     # 添加 "test" 到 `WORKDIR`/relativeDir/\n    ADD test /absoluteDir/    # 添加 "test" 到 /absoluteDir/\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h3",{attrs:{id:"copy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#copy"}},[s._v("#")]),s._v(" "),a("strong",[s._v("COPY")])]),s._v(" "),a("p",[s._v("功能类似ADD，但是是不会自动解压文件，也不能访问网络资源")]),s._v(" "),a("h3",{attrs:{id:"cmd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cmd"}},[s._v("#")]),s._v(" "),a("strong",[s._v("CMD")])]),s._v(" "),a("p",[s._v("构建容器后调用，也就是在容器启动时才进行调用。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('格式：\n    CMD ["executable","param1","param2"] (执行可执行文件，优先)\n    CMD ["param1","param2"] (设置了ENTRYPOINT，则直接调用ENTRYPOINT添加参数)\n    CMD command param1 param2 (执行shell内部命令)\n示例：\n    CMD echo "This is a test." | wc -\n    CMD ["/usr/bin/wc","--help"]注： 　　CMD不同于RUN，CMD用于指定在容器启动时所要执行的命令，而RUN用于指定镜像构建时所要执行的命令。\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h3",{attrs:{id:"entrypoint"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#entrypoint"}},[s._v("#")]),s._v(" "),a("strong",[s._v("ENTRYPOINT")])]),s._v(" "),a("p",[s._v('配置容器，使其可执行化。配合CMD可省去"application"，只使用参数。')]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('格式：\n    ENTRYPOINT ["executable", "param1", "param2"] (可执行文件, 优先)\n    ENTRYPOINT command param1 param2 (shell内部命令)\n示例：\n    FROM ubuntu\n    ENTRYPOINT ["top", "-b"]\n    CMD ["-c"]\n    注：ENTRYPOINT与CMD非常类似，不同的是通过docker run执行的命令不会覆盖ENTRYPOINT，而docker run命令中指定的任何参数，都会被当做参数再次传递给ENTRYPOINT。\n    Dockerfile中只允许有一个ENTRYPOINT命令，多指定时会覆盖前面的设置，而只执行最后的ENTRYPOINT指令。\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h3",{attrs:{id:"label"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#label"}},[s._v("#")]),s._v(" "),a("strong",[s._v("LABEL")])]),s._v(" "),a("p",[s._v("用于为镜像添加元数据")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('格式：\n    LABEL <key>=<value> <key>=<value> <key>=<value> ...\n示例：\n　　LABEL version="1.0" description="这是一个Web服务器" by="IT笔录"\n注：\n　　使用LABEL指定元数据时，一条LABEL指定可以指定一或多条元数据，指定多条元数据时不同元数据之间通过空格分隔。推荐将所有的元数据通过一条LABEL指令指定，以免生成过多的中间镜像。\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"env"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#env"}},[s._v("#")]),s._v(" "),a("strong",[s._v("ENV")])]),s._v(" "),a("p",[s._v("设置环境变量")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('格式：\n    ENV <key> <value>  #<key>之后的所有内容均会被视为其<value>的组成部分，因此，一次只能设置一个变量\n    ENV <key>=<value> ...  #可以设置多个变量，每个变量为一个"<key>=<value>"的键值对，如果<key>中包含空格，可以使用\\来进行转义，也可以通过""来进行标示；另外，反斜线也可以用于续行\n示例：\n    ENV myName John Doe\n    ENV myDog Rex The Dog\n    ENV myCat=fluffy\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h3",{attrs:{id:"expose"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#expose"}},[s._v("#")]),s._v(" "),a("strong",[s._v("EXPOSE")])]),s._v(" "),a("p",[s._v("指定于外界交互的端口")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("格式：\n    EXPOSE <port> [<port>...]\n示例：\n    EXPOSE 80 443\n    EXPOSE 8080    EXPOSE 11211/tcp 11211/udp注：　　EXPOSE并不会让容器的端口访问到主机。要使其可访问，需要在docker run运行容器时通过-p来发布这些端口，或通过-P参数来发布EXPOSE导出的所有端口\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"volume"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#volume"}},[s._v("#")]),s._v(" "),a("strong",[s._v("VOLUME")])]),s._v(" "),a("p",[s._v("用于指定持久化目录")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('格式：\n    VOLUME ["/path/to/dir"]\n示例：\n    VOLUME ["/data"]\n    VOLUME ["/var/www", "/var/log/apache2", "/etc/apache2"注：　　一个卷可以存在于一个或多个容器的指定目录，该目录可以绕过联合文件系统，并具有以下功能：\n1 卷可以容器间共享和重用\n2 容器并不一定要和其它容器共享卷\n3 修改卷后会立即生效\n4 对卷的修改不会对镜像产生影响\n5 卷会一直存在，直到没有任何容器在使用它\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h3",{attrs:{id:"workdir"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#workdir"}},[s._v("#")]),s._v(" "),a("strong",[s._v("WORKDIR")])]),s._v(" "),a("p",[s._v("工作目录，类似于cd命令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("格式：\n    WORKDIR /path/to/workdir\n示例：\n    WORKDIR /a  (这时工作目录为/a)\n    WORKDIR b  (这时工作目录为/a/b)\n    WORKDIR c  (这时工作目录为/a/b/c)注：　　通过WORKDIR设置工作目录后，Dockerfile中其后的命令RUN、CMD、ENTRYPOINT、ADD、COPY等命令都会在该目录下执行。在使用docker run运行容器时，可以通过-w参数覆盖构建时所设置的工作目录。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"user"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#user"}},[s._v("#")]),s._v(" "),a("strong",[s._v("USER")])]),s._v(" "),a("p",[s._v("指定运行容器时的用户名或 UID，后续的 RUN 也会使用指定用户。使用USER指定用户时，可以使用用户名、UID或GID，或是两者的组合。当服务不需要管理员权限时，可以通过该命令指定运行用户。并且可以在之前创建所需要的用户")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v(" 格式:\n　　"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" user\n　　"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" user:group\n　　"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" uid\n　　"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" uid:gid\n　　"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" user:gid\n　　"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" uid:group\n\n 示例：\n　　"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" www\n\n 注：\n\n　　使用"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("指定用户后，Dockerfile中其后的命令RUN、CMD、ENTRYPOINT都将使用该用户。镜像构建完成后，通过"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("运行容器时，可以通过-u参数来覆盖所指定的用户。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h3",{attrs:{id:"arg"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#arg"}},[s._v("#")]),s._v(" "),a("strong",[s._v("ARG")])]),s._v(" "),a("p",[s._v("用于指定传递给构建运行时的变量")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("格式：\n    ARG <name>[=<default value>]\n示例：\n    ARG site\n    ARG build_user=www\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"onbuild"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#onbuild"}},[s._v("#")]),s._v(" "),a("strong",[s._v("ONBUILD")])]),s._v(" "),a("p",[s._v("用于设置镜像触发器")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("格式：　　ONBUILD [INSTRUCTION]\n示例：\n　　ONBUILD ADD . /app/src\n　　ONBUILD RUN /usr/local/bin/python-build --dir /app/src\n注：　　当所构建的镜像被用做其它镜像的基础镜像，该镜像中的触发器将会被钥触发\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[a("strong",[s._v("以下是一个小例子：")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('# This my first nginx Dockerfile\n# Version 1.0\n\n# Base images 基础镜像\nFROM centos\n\n#MAINTAINER 维护者信息\nMAINTAINER tianfeiyu \n\n#ENV 设置环境变量\nENV PATH /usr/local/nginx/sbin:$PATH\n\n#ADD  文件放在当前目录下，拷过去会自动解压\nADD nginx-1.8.0.tar.gz /usr/local/  \nADD epel-release-latest-7.noarch.rpm /usr/local/  \n\n#RUN 执行以下命令 \nRUN rpm -ivh /usr/local/epel-release-latest-7.noarch.rpm\nRUN yum install -y wget lftp gcc gcc-c++ make openssl-devel pcre-devel pcre && yum clean all\nRUN useradd -s /sbin/nologin -M www\n\n#WORKDIR 相当于cd\nWORKDIR /usr/local/nginx-1.8.0 \n\nRUN ./configure --prefix=/usr/local/nginx --user=www --group=www --with-http_ssl_module --with-pcre && make && make install\n\nRUN echo "daemon off;" >> /etc/nginx.conf\n\n#EXPOSE 映射端口\nEXPOSE 80\n\n#CMD 运行以下命令\nCMD ["nginx"]\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br")])]),a("p",[a("strong",[s._v("最后用一张图解释常用指令的意义")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://images2017.cnblogs.com/blog/911490/201712/911490-20171208222222062-849020400.png",alt:"img"}})])])}],!1,null,null,null);a.default=t.exports}}]);